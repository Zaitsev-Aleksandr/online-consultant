!function(t,e){"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified("knockout")?define(["js/jquery","knockout"],e):e(t.jQuery,t.ko)}(this,(function(t, e){"use strict";function i(e, i){this.$select=t(e),this.options=this.mergeOptions(t.extend({},i,this.$select.data())),this.$select.attr("data-placeholder")&&(this.options.nonSelectedText=this.$select.data("placeholder")),this.originalOptions=this.$select.clone()[0].options,this.query="",this.searchTimeout=null,this.lastToggledInput=null,this.options.multiple="multiple"===this.$select.attr("multiple"),this.options.onChange=t.proxy(this.options.onChange,this),this.options.onSelectAll=t.proxy(this.options.onSelectAll,this),this.options.onDeselectAll=t.proxy(this.options.onDeselectAll,this),this.options.onDropdownShow=t.proxy(this.options.onDropdownShow,this),this.options.onDropdownHide=t.proxy(this.options.onDropdownHide,this),this.options.onDropdownShown=t.proxy(this.options.onDropdownShown,this),this.options.onDropdownHidden=t.proxy(this.options.onDropdownHidden,this),this.options.onInitialized=t.proxy(this.options.onInitialized,this),this.options.onFiltering=t.proxy(this.options.onFiltering,this),this.buildContainer(),this.buildButton(),this.buildDropdown(),this.buildReset(),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(!0),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups(),this.options.wasDisabled=this.$select.prop("disabled"),this.options.disableIfEmpty&&t("option",this.$select).length<=0&&this.disable(),this.$select.wrap('<span class="multiselect-native-select" />').after(this.$container),this.options.onInitialized(this.$select,this.$container)}void 0!==e&&e.bindingHandlers&&!e.bindingHandlers.multiselect&&(e.bindingHandlers.multiselect={after:["options","value","selectedOptions","enable","disable"],init:function(i,s,l,o,n){var a=t(i),p=e.toJS(s());if(a.multiselect(p),l.has("options")){var h=l.get("options");e.isObservable(h)&&e.computed({read:function(){h(),setTimeout((function(){var t=a.data("multiselect");t&&t.updateOriginalOptions(),a.multiselect("rebuild")}),1)},disposeWhenNodeIsRemoved:i})}if(l.has("value")){var c=l.get("value");e.isObservable(c)&&e.computed({read:function(){c(),setTimeout((function(){a.multiselect("refresh")}),1)},disposeWhenNodeIsRemoved:i}).extend({rateLimit:100,notifyWhenChangesStop:!0})}if(l.has("selectedOptions")){var r=l.get("selectedOptions");e.isObservable(r)&&e.computed({read:function(){r(),setTimeout((function(){a.multiselect("refresh")}),1)},disposeWhenNodeIsRemoved:i}).extend({rateLimit:100,notifyWhenChangesStop:!0})}var u=function(t){setTimeout((function(){t?a.multiselect("enable"):a.multiselect("disable")}))};if(l.has("enable")){var d=l.get("enable");e.isObservable(d)?e.computed({read:function(){u(d())},disposeWhenNodeIsRemoved:i}).extend({rateLimit:100,notifyWhenChangesStop:!0}):u(d)}if(l.has("disable")){var b=l.get("disable");e.isObservable(b)?e.computed({read:function(){u(!b())},disposeWhenNodeIsRemoved:i}).extend({rateLimit:100,notifyWhenChangesStop:!0}):u(!b)}e.utils.domNodeDisposal.addDisposeCallback(i,(function(){a.multiselect("destroy")}))},update:function(i,s,l,o,n){var a=t(i),p=e.toJS(s());a.multiselect("setOptions",p),a.multiselect("rebuild")}}),i.prototype={defaults:{buttonText:function(e,i){if(this.disabledText.length>0&&(i.prop("disabled")||0==e.length&&this.disableIfEmpty))return this.disabledText;if(0===e.length)return this.nonSelectedText;if(this.allSelectedText&&e.length===t("option",t(i)).length&&1!==t("option",t(i)).length&&this.multiple)return this.selectAllNumber?this.allSelectedText+" ("+e.length+")":this.allSelectedText;if(0!=this.numberDisplayed&&e.length>this.numberDisplayed)return e.length+" "+this.nSelectedText;var s="",l=this.delimiterText;return e.each((function(){var e=void 0!==t(this).attr("label")?t(this).attr("label"):t(this).text();s+=e+l})),s.substr(0,s.length-this.delimiterText.length)},buttonTitle:function(e,i){if(0===e.length)return this.nonSelectedText;var s="",l=this.delimiterText;return e.each((function(){var e=void 0!==t(this).attr("label")?t(this).attr("label"):t(this).text();s+=e+l})),s.substr(0,s.length-this.delimiterText.length)},checkboxName:function(t){return!1},optionLabel:function(e){return t(e).attr("label")||t(e).text()},optionClass:function(e){return t(e).attr("class")||""},onChange:function(t,e){},onDropdownShow:function(t){},onDropdownHide:function(t){},onDropdownShown:function(t){},onDropdownHidden:function(t){},onSelectAll:function(){},onDeselectAll:function(){},onInitialized:function(t,e){},onFiltering:function(t){},enableHTML:!1,buttonClass:"btn btn-default",inheritClass:!1,buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',dropRight:!1,dropUp:!1,selectedClass:"active",maxHeight:!1,includeSelectAllOption:!1,includeSelectAllIfMoreThan:0,selectAllText:" Все",selectAllValue:"multiselect-all",selectAllName:!1,selectAllNumber:!0,selectAllJustVisible:!0,enableFiltering:!1,enableCaseInsensitiveFiltering:!1,enableFullValueFiltering:!1,enableClickableOptGroups:!1,enableCollapsibleOptGroups:!1,collapseOptGroupsByDefault:!1,filterPlaceholder:"Search",filterBehavior:"text",includeFilterClearBtn:!0,preventInputChangeEvent:!1,nonSelectedText:"Выбрать",nSelectedText:"selected",allSelectedText:"All selected",numberDisplayed:3,disableIfEmpty:!1,disabledText:"",delimiterText:", ",includeResetOption:!1,includeResetDivider:!1,resetText:"Reset",templates:{button:'<button type="button" class="multiselect dropdown-toggle" data-toggle="dropdown"><span class="multiselect-selected-text"></span> <b class="caret"></b></button>',ul:'<ul class="multiselect-container dropdown-menu"></ul>',filter:'<li class="multiselect-item multiselect-filter"><div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text" /></div></li>',filterClearBtn:'<span class="input-group-btn"><button class="btn btn-default multiselect-clear-filter" type="button"><i class="glyphicon glyphicon-remove-circle"></i></button></span>',li:'<li><a tabindex="0"><label></label></a></li>',divider:'<li class="multiselect-item divider"></li>',liGroup:'<li class="multiselect-item multiselect-group"><label></label></li>',resetButton:'<li class="multiselect-reset text-center"><div class="input-group"><a class="btn btn-default btn-block"></a></div></li>'}},constructor:i,buildContainer:function(){this.$container=t(this.options.buttonContainer),this.$container.on("show.bs.dropdown",this.options.onDropdownShow),this.$container.on("hide.bs.dropdown",this.options.onDropdownHide),this.$container.on("shown.bs.dropdown",this.options.onDropdownShown),this.$container.on("hidden.bs.dropdown",this.options.onDropdownHidden)},buildButton:function(){this.$button=t(this.options.templates.button).addClass(this.options.buttonClass),this.$select.attr("class")&&this.options.inheritClass&&this.$button.addClass(this.$select.attr("class")),this.$select.prop("disabled")?this.disable():this.enable(),this.options.buttonWidth&&"auto"!==this.options.buttonWidth&&(this.$button.css({width:"100%",overflow:"hidden","text-overflow":"ellipsis"}),this.$container.css({width:this.options.buttonWidth}));var e=this.$select.attr("tabindex");e&&this.$button.attr("tabindex",e),this.$container.prepend(this.$button)},buildDropdown:function(){if(this.$ul=t(this.options.templates.ul),this.options.dropRight&&this.$ul.addClass("pull-right"),this.options.maxHeight&&this.$ul.css({"max-height":this.options.maxHeight+"px","overflow-y":"auto","overflow-x":"hidden"}),this.options.dropUp){var e=Math.min(this.options.maxHeight,26*t('option[data-role!="divider"]',this.$select).length+19*t('option[data-role="divider"]',this.$select).length+(this.options.includeSelectAllOption?26:0)+(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering?44:0)),i=e+34;this.$ul.css({"max-height":e+"px","overflow-y":"auto","overflow-x":"hidden","margin-top":"-"+i+"px"})}this.$container.append(this.$ul)},buildDropdownOptions:function(){this.$select.children().each(t.proxy((function(e,i){var s=t(i),l=s.prop("tagName").toLowerCase();s.prop("value")!==this.options.selectAllValue&&("optgroup"===l?this.createOptgroup(i):"option"===l&&("divider"===s.data("role")?this.createDivider():this.createOptionValue(i)))}),this)),t(this.$ul).off("change",'li:not(.multiselect-group) input[type="checkbox"], li:not(.multiselect-group) input[type="radio"]'),t(this.$ul).on("change",'li:not(.multiselect-group) input[type="checkbox"], li:not(.multiselect-group) input[type="radio"]',t.proxy((function(e){var i=t(e.target),s=i.prop("checked")||!1,l=i.val()===this.options.selectAllValue;this.options.selectedClass&&(s?i.closest("li").addClass(this.options.selectedClass):i.closest("li").removeClass(this.options.selectedClass));var o=i.val(),n=this.getOptionByValue(o),a=t("option",this.$select).not(n),p=t("input",this.$container).not(i);if(l?s?this.selectAll(this.options.selectAllJustVisible,!0):this.deselectAll(this.options.selectAllJustVisible,!0):(s?(n.prop("selected",!0),this.options.multiple?n.prop("selected",!0):(this.options.selectedClass&&t(p).closest("li").removeClass(this.options.selectedClass),t(p).prop("checked",!1),a.prop("selected",!1),this.$button.click()),"active"===this.options.selectedClass&&a.closest("a").css("outline","")):n.prop("selected",!1),this.options.onChange(n,s),this.updateSelectAll(),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups()),this.$select.change(),this.updateButtonText(),this.options.preventInputChangeEvent)return!1}),this)),t("li a",this.$ul).on("mousedown",(function(t){if(t.shiftKey)return!1})),t(this.$ul).on("touchstart click","li a",t.proxy((function(e){e.stopPropagation();var i=t(e.target);if(e.shiftKey&&this.options.multiple){i.is("label")&&(e.preventDefault(),(i=i.find("input")).prop("checked",!i.prop("checked")));var s=i.prop("checked")||!1;if(null!==this.lastToggledInput&&this.lastToggledInput!==i){var l=this.$ul.find("li:visible").index(i.parents("li")),o=this.$ul.find("li:visible").index(this.lastToggledInput.parents("li"));if(l>o){var n=o;o=l,l=n}++o;var a=this.$ul.find("li").not(".multiselect-filter-hidden").slice(l,o).find("input");a.prop("checked",s),this.options.selectedClass&&a.closest("li").toggleClass(this.options.selectedClass,s);for(var p=0,h=a.length;p<h;p++){var c=t(a[p]);this.getOptionByValue(c.val()).prop("selected",s)}}i.trigger("change")}i.is("input")&&!i.closest("li").is(".multiselect-item")&&(this.lastToggledInput=i),i.blur()}),this)),this.$container.off("keydown.multiselect").on("keydown.multiselect",t.proxy((function(e){if(!t('input[type="text"]',this.$container).is(":focus"))if(9===e.keyCode&&this.$container.hasClass("open"))this.$button.click();else{var i=t(this.$container).find("li:not(.divider):not(.disabled) a").filter(":visible");if(!i.length)return;var s=i.index(i.filter(":focus"));38===e.keyCode&&s>0?s--:40===e.keyCode&&s<i.length-1?s++:~s||(s=0);var l=i.eq(s);if(l.focus(),32===e.keyCode||13===e.keyCode){var o=l.find("input");o.prop("checked",!o.prop("checked")),o.change()}e.stopPropagation(),e.preventDefault()}}),this)),this.options.enableClickableOptGroups&&this.options.multiple&&t("li.multiselect-group input",this.$ul).on("change",t.proxy((function(e){e.stopPropagation();var i=t(e.target).prop("checked")||!1,s=t(e.target).closest("li"),l=s.nextUntil("li.multiselect-group").not(".multiselect-filter-hidden").not(".disabled").find("input"),o=[];this.options.selectedClass&&(i?s.addClass(this.options.selectedClass):s.removeClass(this.options.selectedClass)),t.each(l,t.proxy((function(e,s){var l=t(s).val(),n=this.getOptionByValue(l);i?(t(s).prop("checked",!0),t(s).closest("li").addClass(this.options.selectedClass),n.prop("selected",!0)):(t(s).prop("checked",!1),t(s).closest("li").removeClass(this.options.selectedClass),n.prop("selected",!1)),o.push(this.getOptionByValue(l))}),this)),this.options.onChange(o,i),this.$select.change(),this.updateButtonText(),this.updateSelectAll()}),this)),this.options.enableCollapsibleOptGroups&&this.options.multiple&&(t("li.multiselect-group .caret-container",this.$ul).on("click",t.proxy((function(e){var i=t(e.target).closest("li").nextUntil("li.multiselect-group").not(".multiselect-filter-hidden"),s=!0;i.each((function(){s=s&&!t(this).hasClass("multiselect-collapsible-hidden")})),s?i.hide().addClass("multiselect-collapsible-hidden"):i.show().removeClass("multiselect-collapsible-hidden")}),this)),t("li.multiselect-all",this.$ul).css("background","#f3f3f3").css("border-bottom","1px solid #eaeaea"),t("li.multiselect-all > a > label.checkbox",this.$ul).css("padding","3px 20px 3px 35px"),t("li.multiselect-group > a > input",this.$ul).css("margin","4px 0px 5px -20px"))},createOptionValue:function(e){var i=t(e);i.is(":selected")&&i.prop("selected",!0);var s=this.options.optionLabel(e),l=this.options.optionClass(e),o=i.val(),n=this.options.multiple?"checkbox":"radio",a=t(this.options.templates.li),p=t("label",a);p.addClass(n),p.attr("title",s),a.addClass(l),this.options.collapseOptGroupsByDefault&&"optgroup"===t(e).parent().prop("tagName").toLowerCase()&&(a.addClass("multiselect-collapsible-hidden"),a.hide()),this.options.enableHTML?p.html(" "+s):p.text(" "+s);var h=t("<input/>").attr("type",n),c=this.options.checkboxName(i);c&&h.attr("name",c),p.prepend(h);var r=i.prop("selected")||!1;h.val(o),o===this.options.selectAllValue&&(a.addClass("multiselect-item multiselect-all"),h.parent().parent().addClass("multiselect-all")),p.attr("title",i.attr("title")),this.$ul.append(a),i.is(":disabled")&&h.attr("disabled","disabled").prop("disabled",!0).closest("a").attr("tabindex","-1").closest("li").addClass("disabled"),h.prop("checked",r),r&&this.options.selectedClass&&h.closest("li").addClass(this.options.selectedClass)},createDivider:function(e){var i=t(this.options.templates.divider);this.$ul.append(i)},createOptgroup:function(e){var i=t(e).attr("label"),s=t(e).attr("value"),l=t('<li class="multiselect-item multiselect-group"><a href="javascript:void(0);"><label><b></b></label></a></li>'),o=this.options.optionClass(e);l.addClass(o),this.options.enableHTML?t("label b",l).html(" "+i):t("label b",l).text(" "+i),this.options.enableCollapsibleOptGroups&&this.options.multiple&&t("a",l).append('<span class="caret-container"><b class="caret"></b></span>'),this.options.enableClickableOptGroups&&this.options.multiple&&t("a label",l).prepend('<input type="checkbox" value="'+s+'"/>'),t(e).is(":disabled")&&l.addClass("disabled"),this.$ul.append(l),t("option",e).each(t.proxy((function(t,e){this.createOptionValue(e)}),this))},buildReset:function(){if(this.options.includeResetOption){this.options.includeResetDivider&&this.$ul.prepend(t(this.options.templates.divider));var e=t(this.options.templates.resetButton);this.options.enableHTML?t("a",e).html(this.options.resetText):t("a",e).text(this.options.resetText),t("a",e).click(t.proxy((function(){this.clearSelection()}),this)),this.$ul.prepend(e)}},buildSelectAll:function(){if("number"==typeof this.options.selectAllValue&&(this.options.selectAllValue=this.options.selectAllValue.toString()),!this.hasSelectAll()&&this.options.includeSelectAllOption&&this.options.multiple&&t("option",this.$select).length>this.options.includeSelectAllIfMoreThan){this.options.includeSelectAllDivider&&this.$ul.prepend(t(this.options.templates.divider));var e=t(this.options.templates.li);t("label",e).addClass("checkbox"),this.options.enableHTML?t("label",e).html(" "+this.options.selectAllText):t("label",e).text(" "+this.options.selectAllText),this.options.selectAllName?t("label",e).prepend('<input type="checkbox" name="'+this.options.selectAllName+'" />'):t("label",e).prepend('<input type="checkbox" />');var i=t("input",e);i.val(this.options.selectAllValue),e.addClass("multiselect-item multiselect-all"),i.parent().parent().addClass("multiselect-all"),this.$ul.prepend(e),i.prop("checked",!1)}},buildFilter:function(){if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var e=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find("option").length>=e){if(this.$filter=t(this.options.templates.filter),t("input",this.$filter).attr("placeholder",this.options.filterPlaceholder),this.options.includeFilterClearBtn){var i=t(this.options.templates.filterClearBtn);i.on("click",t.proxy((function(e){clearTimeout(this.searchTimeout),this.query="",this.$filter.find(".multiselect-search").val(""),t("li",this.$ul).show().removeClass("multiselect-filter-hidden"),this.updateSelectAll(),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups()}),this)),this.$filter.find(".input-group").append(i)}this.$ul.prepend(this.$filter),this.$filter.val(this.query).on("click",(function(t){t.stopPropagation()})).on("input keydown",t.proxy((function(e){13===e.which&&e.preventDefault(),clearTimeout(this.searchTimeout),this.searchTimeout=this.asyncFunction(t.proxy((function(){var i,s;this.query!==e.target.value&&(this.query=e.target.value,t.each(t("li",this.$ul),t.proxy((function(e,l){var o=t("input",l).length>0?t("input",l).val():"",n=t("label",l).text(),a="";if("text"===this.options.filterBehavior?a=n:"value"===this.options.filterBehavior?a=o:"both"===this.options.filterBehavior&&(a=n+"\n"+o),o!==this.options.selectAllValue&&n){var p=!1;if(this.options.enableCaseInsensitiveFiltering&&(a=a.toLowerCase(),this.query=this.query.toLowerCase()),this.options.enableFullValueFiltering&&"both"!==this.options.filterBehavior){var h=a.trim().substring(0,this.query.length);this.query.indexOf(h)>-1&&(p=!0)}else a.indexOf(this.query)>-1&&(p=!0);p||(t(l).css("display","none"),t(l).addClass("multiselect-filter-hidden")),p&&(t(l).css("display","block"),t(l).removeClass("multiselect-filter-hidden")),t(l).hasClass("multiselect-group")?(i=l,s=p):(p&&t(i).show().removeClass("multiselect-filter-hidden"),!p&&s&&t(l).show().removeClass("multiselect-filter-hidden"))}}),this)));this.updateSelectAll(),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups(),this.options.onFiltering(e.target)}),this),300,this)}),this))}}},destroy:function(){this.$container.remove(),this.$select.show(),this.$select.prop("disabled",this.options.wasDisabled),this.$select.data("multiselect",null)},refresh:function(){var e={};t("li input",this.$ul).each((function(){e[t(this).val()]=t(this)})),t("option",this.$select).each(t.proxy((function(i,s){var l=t(s),o=e[t(s).val()];l.is(":selected")?(o.prop("checked",!0),this.options.selectedClass&&o.closest("li").addClass(this.options.selectedClass)):(o.prop("checked",!1),this.options.selectedClass&&o.closest("li").removeClass(this.options.selectedClass)),l.is(":disabled")?o.attr("disabled","disabled").prop("disabled",!0).closest("li").addClass("disabled"):o.prop("disabled",!1).closest("li").removeClass("disabled")}),this)),this.updateButtonText(),this.updateSelectAll(),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups()},select:function(e,i){t.isArray(e)||(e=[e]);for(var s=0;s<e.length;s++){var l=e[s];if(null!=l){var o=this.getOptionByValue(l),n=this.getInputByValue(l);void 0!==o&&void 0!==n&&(this.options.multiple||this.deselectAll(!1),this.options.selectedClass&&n.closest("li").addClass(this.options.selectedClass),n.prop("checked",!0),o.prop("selected",!0),i&&this.options.onChange(o,!0))}}this.updateButtonText(),this.updateSelectAll(),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups()},clearSelection:function(){this.deselectAll(!1),this.updateButtonText(),this.updateSelectAll(),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups()},deselect:function(e,i){t.isArray(e)||(e=[e]);for(var s=0;s<e.length;s++){var l=e[s];if(null!=l){var o=this.getOptionByValue(l),n=this.getInputByValue(l);void 0!==o&&void 0!==n&&(this.options.selectedClass&&n.closest("li").removeClass(this.options.selectedClass),n.prop("checked",!1),o.prop("selected",!1),i&&this.options.onChange(o,!1))}}this.updateButtonText(),this.updateSelectAll(),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups()},selectAll:function(e,i){e=void 0===e||e;var s=t("li:not(.divider):not(.disabled):not(.multiselect-group)",this.$ul),l=t("li:not(.divider):not(.disabled):not(.multiselect-group):not(.multiselect-filter-hidden):not(.multiselect-collapisble-hidden)",this.$ul).filter(":visible");e?(t("input:enabled",l).prop("checked",!0),l.addClass(this.options.selectedClass),t("input:enabled",l).each(t.proxy((function(e,i){var s=t(i).val(),l=this.getOptionByValue(s);t(l).prop("selected",!0)}),this))):(t("input:enabled",s).prop("checked",!0),s.addClass(this.options.selectedClass),t("input:enabled",s).each(t.proxy((function(e,i){var s=t(i).val(),l=this.getOptionByValue(s);t(l).prop("selected",!0)}),this))),t('li input[value="'+this.options.selectAllValue+'"]',this.$ul).prop("checked",!0),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups(),i&&this.options.onSelectAll()},deselectAll:function(e,i){e=void 0===e||e;var s=t("li:not(.divider):not(.disabled):not(.multiselect-group)",this.$ul),l=t("li:not(.divider):not(.disabled):not(.multiselect-group):not(.multiselect-filter-hidden):not(.multiselect-collapisble-hidden)",this.$ul).filter(":visible");e?(t('input[type="checkbox"]:enabled',l).prop("checked",!1),l.removeClass(this.options.selectedClass),t('input[type="checkbox"]:enabled',l).each(t.proxy((function(e,i){var s=t(i).val(),l=this.getOptionByValue(s);t(l).prop("selected",!1)}),this))):(t('input[type="checkbox"]:enabled',s).prop("checked",!1),s.removeClass(this.options.selectedClass),t('input[type="checkbox"]:enabled',s).each(t.proxy((function(e,i){var s=t(i).val(),l=this.getOptionByValue(s);t(l).prop("selected",!1)}),this))),t('li input[value="'+this.options.selectAllValue+'"]',this.$ul).prop("checked",!1),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups(),i&&this.options.onDeselectAll()},rebuild:function(){this.$ul.html(""),this.options.multiple="multiple"===this.$select.attr("multiple"),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(!0),this.options.enableClickableOptGroups&&this.options.multiple&&this.updateOptGroups(),this.options.disableIfEmpty&&t("option",this.$select).length<=0?this.disable():this.enable(),this.options.dropRight&&this.$ul.addClass("pull-right")},dataprovider:function(e){var i=0,s=this.$select.empty();t.each(e,(function(e,l){var o;if(t.isArray(l.children))i++,o=t("<optgroup/>").attr({label:l.label||"Group "+i,disabled:!!l.disabled,value:l.value}),function(t,e){for(var i=0;i<t.length;++i)e(t[i],i)}(l.children,(function(e){var i={value:e.value,label:e.label||e.value,title:e.title,selected:!!e.selected,disabled:!!e.disabled};for(var s in e.attributes)i["data-"+s]=e.attributes[s];o.append(t("<option/>").attr(i))}));else{var n={value:l.value,label:l.label||l.value,title:l.title,class:l.class,selected:!!l.selected,disabled:!!l.disabled};for(var a in l.attributes)n["data-"+a]=l.attributes[a];(o=t("<option/>").attr(n)).text(l.label||l.value)}s.append(o)})),this.rebuild()},enable:function(){this.$select.prop("disabled",!1),this.$button.prop("disabled",!1).removeClass("disabled")},disable:function(){this.$select.prop("disabled",!0),this.$button.prop("disabled",!0).addClass("disabled")},setOptions:function(t){this.options=this.mergeOptions(t)},mergeOptions:function(e){return t.extend(!0,{},this.defaults,this.options,e)},hasSelectAll:function(){return t("li.multiselect-all",this.$ul).length>0},updateOptGroups:function(){var e=t("li.multiselect-group",this.$ul),i=this.options.selectedClass;e.each((function(){var e=t(this).nextUntil("li.multiselect-group").not(".multiselect-filter-hidden").not(".disabled"),s=!0;e.each((function(){t("input",this).prop("checked")||(s=!1)})),i&&(s?t(this).addClass(i):t(this).removeClass(i)),t("input",this).prop("checked",s)}))},updateSelectAll:function(e){if(this.hasSelectAll()){var i=t("li:not(.multiselect-item):not(.multiselect-filter-hidden):not(.multiselect-group):not(.disabled) input:enabled",this.$ul),s=i.length,l=i.filter(":checked").length,o=t("li.multiselect-all",this.$ul),n=o.find("input");l>0&&l===s?(n.prop("checked",!0),o.addClass(this.options.selectedClass)):(n.prop("checked",!1),o.removeClass(this.options.selectedClass))}},updateButtonText:function(){var e=this.getSelected();this.options.enableHTML?t(".multiselect .multiselect-selected-text",this.$container).html(this.options.buttonText(e,this.$select)):t(".multiselect .multiselect-selected-text",this.$container).text(this.options.buttonText(e,this.$select)),t(".multiselect",this.$container).attr("title",this.options.buttonTitle(e,this.$select))},getSelected:function(){return t("option",this.$select).filter(":selected")},getOptionByValue:function(e){for(var i=t("option",this.$select),s=e.toString(),l=0;l<i.length;l+=1){var o=i[l];if(o.value===s)return t(o)}},getInputByValue:function(e){for(var i=t("li input:not(.multiselect-search)",this.$ul),s=e.toString(),l=0;l<i.length;l+=1){var o=i[l];if(o.value===s)return t(o)}},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options},asyncFunction:function(t,e,i){var s=Array.prototype.slice.call(arguments,3);return setTimeout((function(){t.apply(i||window,s)}),e)},setAllSelectedText:function(t){this.options.allSelectedText=t,this.updateButtonText()}},t.fn.multiselect=function(e,s,l){return this.each((function(){var o=t(this).data("multiselect");o||(o=new i(this,"object"==typeof e&&e),t(this).data("multiselect",o)),"string"==typeof e&&(o[e](s,l),"destroy"===e&&t(this).data("multiselect",!1))}))},t.fn.multiselect.Constructor=i,t((function(){t("select[data-role=multiselect]").multiselect()}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvb3RzdHJhcC1tdWx0aXNlbGVjdC5qcyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsInJlcXVpcmUiLCJzcGVjaWZpZWQiLCJqUXVlcnkiLCJrbyIsInRoaXMiLCIkIiwiTXVsdGlzZWxlY3QiLCJzZWxlY3QiLCJvcHRpb25zIiwiJHNlbGVjdCIsIm1lcmdlT3B0aW9ucyIsImV4dGVuZCIsImRhdGEiLCJhdHRyIiwibm9uU2VsZWN0ZWRUZXh0Iiwib3JpZ2luYWxPcHRpb25zIiwiY2xvbmUiLCJxdWVyeSIsInNlYXJjaFRpbWVvdXQiLCJsYXN0VG9nZ2xlZElucHV0IiwibXVsdGlwbGUiLCJvbkNoYW5nZSIsInByb3h5Iiwib25TZWxlY3RBbGwiLCJvbkRlc2VsZWN0QWxsIiwib25Ecm9wZG93blNob3ciLCJvbkRyb3Bkb3duSGlkZSIsIm9uRHJvcGRvd25TaG93biIsIm9uRHJvcGRvd25IaWRkZW4iLCJvbkluaXRpYWxpemVkIiwib25GaWx0ZXJpbmciLCJidWlsZENvbnRhaW5lciIsImJ1aWxkQnV0dG9uIiwiYnVpbGREcm9wZG93biIsImJ1aWxkUmVzZXQiLCJidWlsZFNlbGVjdEFsbCIsImJ1aWxkRHJvcGRvd25PcHRpb25zIiwiYnVpbGRGaWx0ZXIiLCJ1cGRhdGVCdXR0b25UZXh0IiwidXBkYXRlU2VsZWN0QWxsIiwiZW5hYmxlQ2xpY2thYmxlT3B0R3JvdXBzIiwidXBkYXRlT3B0R3JvdXBzIiwid2FzRGlzYWJsZWQiLCJwcm9wIiwiZGlzYWJsZUlmRW1wdHkiLCJsZW5ndGgiLCJkaXNhYmxlIiwid3JhcCIsImFmdGVyIiwiJGNvbnRhaW5lciIsImJpbmRpbmdIYW5kbGVycyIsIm11bHRpc2VsZWN0IiwiaW5pdCIsImVsZW1lbnQiLCJ2YWx1ZUFjY2Vzc29yIiwiYWxsQmluZGluZ3MiLCJ2aWV3TW9kZWwiLCJiaW5kaW5nQ29udGV4dCIsIiRlbGVtZW50IiwiY29uZmlnIiwidG9KUyIsImhhcyIsImdldCIsImlzT2JzZXJ2YWJsZSIsImNvbXB1dGVkIiwicmVhZCIsInNldFRpbWVvdXQiLCJtcyIsInVwZGF0ZU9yaWdpbmFsT3B0aW9ucyIsImRpc3Bvc2VXaGVuTm9kZUlzUmVtb3ZlZCIsInZhbHVlIiwicmF0ZUxpbWl0Iiwibm90aWZ5V2hlbkNoYW5nZXNTdG9wIiwic2VsZWN0ZWRPcHRpb25zIiwic2V0RW5hYmxlZCIsImVuYWJsZSIsInV0aWxzIiwiZG9tTm9kZURpc3Bvc2FsIiwiYWRkRGlzcG9zZUNhbGxiYWNrIiwidXBkYXRlIiwicHJvdG90eXBlIiwiZGVmYXVsdHMiLCJidXR0b25UZXh0IiwiZGlzYWJsZWRUZXh0IiwiYWxsU2VsZWN0ZWRUZXh0Iiwic2VsZWN0QWxsTnVtYmVyIiwibnVtYmVyRGlzcGxheWVkIiwiblNlbGVjdGVkVGV4dCIsInNlbGVjdGVkIiwiZGVsaW1pdGVyIiwiZGVsaW1pdGVyVGV4dCIsImVhY2giLCJsYWJlbCIsInVuZGVmaW5lZCIsInRleHQiLCJzdWJzdHIiLCJidXR0b25UaXRsZSIsImNoZWNrYm94TmFtZSIsIm9wdGlvbiIsIm9wdGlvbkxhYmVsIiwib3B0aW9uQ2xhc3MiLCJjaGVja2VkIiwiZXZlbnQiLCIkZmlsdGVyIiwiZW5hYmxlSFRNTCIsImJ1dHRvbkNsYXNzIiwiaW5oZXJpdENsYXNzIiwiYnV0dG9uV2lkdGgiLCJidXR0b25Db250YWluZXIiLCJkcm9wUmlnaHQiLCJkcm9wVXAiLCJzZWxlY3RlZENsYXNzIiwibWF4SGVpZ2h0IiwiaW5jbHVkZVNlbGVjdEFsbE9wdGlvbiIsImluY2x1ZGVTZWxlY3RBbGxJZk1vcmVUaGFuIiwic2VsZWN0QWxsVGV4dCIsInNlbGVjdEFsbFZhbHVlIiwic2VsZWN0QWxsTmFtZSIsInNlbGVjdEFsbEp1c3RWaXNpYmxlIiwiZW5hYmxlRmlsdGVyaW5nIiwiZW5hYmxlQ2FzZUluc2Vuc2l0aXZlRmlsdGVyaW5nIiwiZW5hYmxlRnVsbFZhbHVlRmlsdGVyaW5nIiwiZW5hYmxlQ29sbGFwc2libGVPcHRHcm91cHMiLCJjb2xsYXBzZU9wdEdyb3Vwc0J5RGVmYXVsdCIsImZpbHRlclBsYWNlaG9sZGVyIiwiZmlsdGVyQmVoYXZpb3IiLCJpbmNsdWRlRmlsdGVyQ2xlYXJCdG4iLCJwcmV2ZW50SW5wdXRDaGFuZ2VFdmVudCIsImluY2x1ZGVSZXNldE9wdGlvbiIsImluY2x1ZGVSZXNldERpdmlkZXIiLCJyZXNldFRleHQiLCJ0ZW1wbGF0ZXMiLCJidXR0b24iLCJ1bCIsImZpbHRlciIsImZpbHRlckNsZWFyQnRuIiwibGkiLCJkaXZpZGVyIiwibGlHcm91cCIsInJlc2V0QnV0dG9uIiwiY29uc3RydWN0b3IiLCJvbiIsIiRidXR0b24iLCJhZGRDbGFzcyIsImNzcyIsIndpZHRoIiwib3ZlcmZsb3ciLCJ0ZXh0LW92ZXJmbG93IiwidGFiaW5kZXgiLCJwcmVwZW5kIiwiJHVsIiwibWF4LWhlaWdodCIsIm92ZXJmbG93LXkiLCJvdmVyZmxvdy14IiwiaGVpZ2h0IiwiTWF0aCIsIm1pbiIsIm1vdmVDYWxjIiwibWFyZ2luLXRvcCIsImFwcGVuZCIsImNoaWxkcmVuIiwiaW5kZXgiLCJ0YWciLCJ0b0xvd2VyQ2FzZSIsImNyZWF0ZU9wdGdyb3VwIiwiY3JlYXRlRGl2aWRlciIsImNyZWF0ZU9wdGlvblZhbHVlIiwib2ZmIiwiJHRhcmdldCIsInRhcmdldCIsImlzU2VsZWN0QWxsT3B0aW9uIiwidmFsIiwiY2xvc2VzdCIsInJlbW92ZUNsYXNzIiwiJG9wdGlvbiIsImdldE9wdGlvbkJ5VmFsdWUiLCIkb3B0aW9uc05vdFRoaXMiLCJub3QiLCIkY2hlY2tib3hlc05vdFRoaXMiLCJzZWxlY3RBbGwiLCJkZXNlbGVjdEFsbCIsImNsaWNrIiwiY2hhbmdlIiwiZSIsInNoaWZ0S2V5Iiwic3RvcFByb3BhZ2F0aW9uIiwiaXMiLCJwcmV2ZW50RGVmYXVsdCIsImZpbmQiLCJmcm9tIiwicGFyZW50cyIsInRvIiwidG1wIiwicmFuZ2UiLCJzbGljZSIsInRvZ2dsZUNsYXNzIiwiaSIsImoiLCIkY2hlY2tib3giLCJ0cmlnZ2VyIiwiYmx1ciIsImtleUNvZGUiLCJoYXNDbGFzcyIsIiRpdGVtcyIsIiRjdXJyZW50IiwiZXEiLCJmb2N1cyIsIiRsaSIsIiRpbnB1dHMiLCJuZXh0VW50aWwiLCIkb3B0aW9ucyIsImlucHV0IiwicHVzaCIsInZpc2libGUiLCJoaWRlIiwic2hvdyIsImNsYXNzZXMiLCJpbnB1dFR5cGUiLCIkbGFiZWwiLCJwYXJlbnQiLCJodG1sIiwibmFtZSIsIiRkaXZpZGVyIiwiZ3JvdXAiLCIkcmVzZXRCdXR0b24iLCJjbGVhclNlbGVjdGlvbiIsInRvU3RyaW5nIiwiaGFzU2VsZWN0QWxsIiwiaW5jbHVkZVNlbGVjdEFsbERpdmlkZXIiLCJlbmFibGVGaWx0ZXJMZW5ndGgiLCJtYXgiLCJjbGVhckJ0biIsImNsZWFyVGltZW91dCIsIndoaWNoIiwiYXN5bmNGdW5jdGlvbiIsImN1cnJlbnRHcm91cCIsImN1cnJlbnRHcm91cFZpc2libGUiLCJmaWx0ZXJDYW5kaWRhdGUiLCJzaG93RWxlbWVudCIsInZhbHVlVG9NYXRjaCIsInRyaW0iLCJzdWJzdHJpbmciLCJpbmRleE9mIiwiZGVzdHJveSIsInJlbW92ZSIsInJlZnJlc2giLCJpbnB1dHMiLCIkZWxlbSIsIiRpbnB1dCIsInNlbGVjdFZhbHVlcyIsInRyaWdnZXJPbkNoYW5nZSIsImlzQXJyYXkiLCJnZXRJbnB1dEJ5VmFsdWUiLCJkZXNlbGVjdCIsImRlc2VsZWN0VmFsdWVzIiwianVzdFZpc2libGUiLCJ0cmlnZ2VyT25TZWxlY3RBbGwiLCJhbGxMaXMiLCJ2aXNpYmxlTGlzIiwidHJpZ2dlck9uRGVzZWxlY3RBbGwiLCJyZWJ1aWxkIiwiZGF0YXByb3ZpZGVyIiwiZ3JvdXBDb3VudGVyIiwiZW1wdHkiLCIkdGFnIiwiZGlzYWJsZWQiLCJhcnJheSIsImNhbGxiYWNrIiwiZm9yRWFjaCIsInN1Yk9wdGlvbiIsImF0dHJpYnV0ZXMiLCJ0aXRsZSIsImtleSIsImNsYXNzIiwic2V0T3B0aW9ucyIsIiRncm91cHMiLCJub3RUcmlnZ2VyT25TZWxlY3RBbGwiLCJhbGxCb3hlcyIsImFsbEJveGVzTGVuZ3RoIiwiY2hlY2tlZEJveGVzTGVuZ3RoIiwic2VsZWN0QWxsTGkiLCJzZWxlY3RBbGxJbnB1dCIsImdldFNlbGVjdGVkIiwidmFsdWVUb0NvbXBhcmUiLCJjaGVja2JveGVzIiwiY2hlY2tib3giLCJ0aW1lb3V0Iiwic2VsZiIsImFyZ3MiLCJBcnJheSIsImNhbGwiLCJhcmd1bWVudHMiLCJhcHBseSIsIndpbmRvdyIsInNldEFsbFNlbGVjdGVkVGV4dCIsImZuIiwicGFyYW1ldGVyIiwiZXh0cmFPcHRpb25zIiwiQ29uc3RydWN0b3IiXSwibWFwcGluZ3MiOiJDQUNBLFNBQVdBLEVBQU1DLEdBRVMsbUJBQVhDLFFBQXlCQSxPQUFPQyxLQUNwQixtQkFBWkMsU0FBdUQsbUJBQXRCQSxRQUFRQyxXQUE0QkQsUUFBUUMsVUFBVSxZQUc5RkgsT0FBTyxDQUFDLFNBQVUsWUFBYUQsR0FHL0JBLEVBQVFELEVBQUtNLE9BQVFOLEVBQUtPLElBVGxDLENBV0dDLE1BQU0sU0FBVUMsRUFBR0YsR0FDbEIsYUFrSUEsU0FBU0csRUFBWUMsRUFBUUMsR0FFekJKLEtBQUtLLFFBQVVKLEVBQUVFLEdBQ2pCSCxLQUFLSSxRQUFVSixLQUFLTSxhQUFhTCxFQUFFTSxPQUFPLEdBQUlILEVBQVNKLEtBQUtLLFFBQVFHLFNBR2hFUixLQUFLSyxRQUFRSSxLQUFLLHNCQUNsQlQsS0FBS0ksUUFBUU0sZ0JBQWtCVixLQUFLSyxRQUFRRyxLQUFLLGdCQUtyRFIsS0FBS1csZ0JBQWtCWCxLQUFLSyxRQUFRTyxRQUFRLEdBQUdSLFFBQy9DSixLQUFLYSxNQUFRLEdBQ2JiLEtBQUtjLGNBQWdCLEtBQ3JCZCxLQUFLZSxpQkFBbUIsS0FFeEJmLEtBQUtJLFFBQVFZLFNBQTZDLGFBQWxDaEIsS0FBS0ssUUFBUUksS0FBSyxZQUMxQ1QsS0FBS0ksUUFBUWEsU0FBV2hCLEVBQUVpQixNQUFNbEIsS0FBS0ksUUFBUWEsU0FBVWpCLE1BQ3ZEQSxLQUFLSSxRQUFRZSxZQUFjbEIsRUFBRWlCLE1BQU1sQixLQUFLSSxR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Q0FBcUNELEtBQUtrSixLQUN6RHFJLEVBQWlCck4sRUFBTTRKLFdBRWxCOUIsRUFBSSxFQUFHQSxFQUFJd0YsRUFBVy9PLE9BQVF1SixHQUFRLEVBQUcsQ0FDOUMsSUFBSXlGLEVBQVdELEVBQVd4RixHQUMxQixHQUFJeUYsRUFBU3ZOLFFBQVVxTixFQUNuQixPQUFPdFIsRUFBRXdSLEtBUXJCek4sc0JBQXVCLFdBQ25CaEUsS0FBS1csZ0JBQWtCWCxLQUFLSyxRQUFRTyxRQUFRLEdBQUdSLFNBR25Ea08sY0FBZSxTQUFTaUMsRUFBVW1CLEVBQVNDLEdBQ3ZDLElBQUlDLEVBQU9DLE1BQU1qTixVQUFVa0gsTUFBTWdHLEtBQUtDLFVBQVcsR0FDakQsT0FBT2pPLFlBQVcsV0FDZHlNLEVBQVN5QixNQUFNTCxHQUFRTSxPQUFRTCxLQUNoQ0YsSUFHUFEsbUJBQW9CLFNBQVNsTixHQUN6QmhGLEtBQUtJLFFBQVE0RSxnQkFBa0JBLEVBQy9CaEYsS0FBS2tDLHFCQUliakMsRUFBRWtTLEdBQUdwUCxZQUFjLFNBQVMrQyxFQUFRc00sRUFBV0MsR0FDM0MsT0FBT3JTLEtBQUt1RixNQUFLLFdBQ2IsSUFBSS9FLEVBQU9QLEVBQUVELE1BQU1RLEtBQUssZUFJbkJBLElBQ0RBLEVBQU8sSUFBSU4sRUFBWUYsS0FKSyxpQkFBWDhGLEdBQXVCQSxHQUt4QzdGLEVBQUVELE1BQU1RLEtBQUssY0FBZUEsSUFJVixpQkFBWHNGLElBQ1B0RixFQUFLc0YsR0FBUXNNLEVBQVdDLEdBRVQsWUFBWHZNLEdBQ0E3RixFQUFFRCxNQUFNUSxLQUFLLGVBQWUsUUFNNUNQLEVBQUVrUyxHQUFHcFAsWUFBWXVQLFlBQWNwUyxFQUUvQkQsR0FBRSxXQUNFQSxFQUFFLGlDQUFpQzhDIiwiZmlsZSI6ImJvb3RzdHJhcC1tdWx0aXNlbGVjdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gICAgLy8gY2hlY2sgdG8gc2VlIGlmICdrbm9ja291dCcgQU1EIG1vZHVsZSBpcyBzcGVjaWZpZWQgaWYgdXNpbmcgcmVxdWlyZWpzXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCAmJlxuICAgICAgICB0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgcmVxdWlyZS5zcGVjaWZpZWQgPT09ICdmdW5jdGlvbicgJiYgcmVxdWlyZS5zcGVjaWZpZWQoJ2tub2Nrb3V0JykpIHtcblxuICAgICAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG4gICAgICAgIGRlZmluZShbJ2pxdWVyeScsICdrbm9ja291dCddLCBmYWN0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBCcm93c2VyIGdsb2JhbHNcbiAgICAgICAgZmFjdG9yeShyb290LmpRdWVyeSwgcm9vdC5rbyk7XG4gICAgfVxufSkodGhpcywgZnVuY3Rpb24gKCQsIGtvKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7Ly8ganNoaW50IDtfO1xuXG4gICAgaWYgKHR5cGVvZiBrbyAhPT0gJ3VuZGVmaW5lZCcgJiYga28uYmluZGluZ0hhbmRsZXJzICYmICFrby5iaW5kaW5nSGFuZGxlcnMubXVsdGlzZWxlY3QpIHtcbiAgICAgICAga28uYmluZGluZ0hhbmRsZXJzLm11bHRpc2VsZWN0ID0ge1xuICAgICAgICAgICAgYWZ0ZXI6IFsnb3B0aW9ucycsICd2YWx1ZScsICdzZWxlY3RlZE9wdGlvbnMnLCAnZW5hYmxlJywgJ2Rpc2FibGUnXSxcblxuICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3MsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSBrby50b0pTKHZhbHVlQWNjZXNzb3IoKSk7XG5cbiAgICAgICAgICAgICAgICAkZWxlbWVudC5tdWx0aXNlbGVjdChjb25maWcpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGFsbEJpbmRpbmdzLmhhcygnb3B0aW9ucycpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gYWxsQmluZGluZ3MuZ2V0KCdvcHRpb25zJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChrby5pc09ic2VydmFibGUob3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtvLmNvbXB1dGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1zID0gJGVsZW1lbnQuZGF0YSgnbXVsdGlzZWxlY3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcy51cGRhdGVPcmlnaW5hbE9wdGlvbnMoKTsvL05vdCBzdXJlIGhvdyBiZW5lZmljaWFsIHRoaXMgaXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5tdWx0aXNlbGVjdCgncmVidWlsZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3Bvc2VXaGVuTm9kZUlzUmVtb3ZlZDogZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3ZhbHVlIGFuZCBzZWxlY3RlZE9wdGlvbnMgYXJlIHR3by13YXksIHNvIHRoZXNlIHdpbGwgYmUgdHJpZ2dlcmVkIGV2ZW4gYnkgb3VyIG93biBhY3Rpb25zLlxuICAgICAgICAgICAgICAgIC8vSXQgbmVlZHMgc29tZSB3YXkgdG8gdGVsbCBpZiB0aGV5IGFyZSB0cmlnZ2VyZWQgYmVjYXVzZSBvZiB1cyBvciBiZWNhdXNlIG9mIG91dHNpZGUgY2hhbmdlLlxuICAgICAgICAgICAgICAgIC8vSXQgZG9lc24ndCBsb29wIGJ1dCBpdCdzIGEgd2FzdGUgb2YgcHJvY2Vzc2luZy5cbiAgICAgICAgICAgICAgICBpZiAoYWxsQmluZGluZ3MuaGFzKCd2YWx1ZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFsbEJpbmRpbmdzLmdldCgndmFsdWUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtvLmlzT2JzZXJ2YWJsZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtvLmNvbXB1dGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlbGVtZW50Lm11bHRpc2VsZWN0KCdyZWZyZXNoJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcG9zZVdoZW5Ob2RlSXNSZW1vdmVkOiBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5leHRlbmQoeyByYXRlTGltaXQ6IDEwMCwgbm90aWZ5V2hlbkNoYW5nZXNTdG9wOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9Td2l0Y2hlZCBmcm9tIGFycmF5Q2hhbmdlIHN1YnNjcmlwdGlvbiB0byBnZW5lcmFsIHN1YnNjcmlwdGlvbiB1c2luZyAncmVmcmVzaCcuXG4gICAgICAgICAgICAgICAgLy9Ob3Qgc3VyZSBwZXJmb3JtYW5jZSBpcyBhbnkgYmV0dGVyIHVzaW5nICdzZWxlY3QnIGFuZCAnZGVzZWxlY3QnLlxuICAgICAgICAgICAgICAgIGlmIChhbGxCaW5kaW5ncy5oYXMoJ3NlbGVjdGVkT3B0aW9ucycpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZE9wdGlvbnMgPSBhbGxCaW5kaW5ncy5nZXQoJ3NlbGVjdGVkT3B0aW9ucycpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoa28uaXNPYnNlcnZhYmxlKHNlbGVjdGVkT3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtvLmNvbXB1dGVkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRPcHRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5tdWx0aXNlbGVjdCgncmVmcmVzaCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3Bvc2VXaGVuTm9kZUlzUmVtb3ZlZDogZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZXh0ZW5kKHsgcmF0ZUxpbWl0OiAxMDAsIG5vdGlmeVdoZW5DaGFuZ2VzU3RvcDogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzZXRFbmFibGVkID0gZnVuY3Rpb24gKGVuYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmFibGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQubXVsdGlzZWxlY3QoJ2VuYWJsZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlbGVtZW50Lm11bHRpc2VsZWN0KCdkaXNhYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAoYWxsQmluZGluZ3MuaGFzKCdlbmFibGUnKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5hYmxlID0gYWxsQmluZGluZ3MuZ2V0KCdlbmFibGUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtvLmlzT2JzZXJ2YWJsZShlbmFibGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrby5jb21wdXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRFbmFibGVkKGVuYWJsZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3Bvc2VXaGVuTm9kZUlzUmVtb3ZlZDogZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZXh0ZW5kKHsgcmF0ZUxpbWl0OiAxMDAsIG5vdGlmeVdoZW5DaGFuZ2VzU3RvcDogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEVuYWJsZWQoZW5hYmxlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChhbGxCaW5kaW5ncy5oYXMoJ2Rpc2FibGUnKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGlzYWJsZSA9IGFsbEJpbmRpbmdzLmdldCgnZGlzYWJsZScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoa28uaXNPYnNlcnZhYmxlKGRpc2FibGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrby5jb21wdXRlZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRFbmFibGVkKCFkaXNhYmxlKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcG9zZVdoZW5Ob2RlSXNSZW1vdmVkOiBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5leHRlbmQoeyByYXRlTGltaXQ6IDEwMCwgbm90aWZ5V2hlbkNoYW5nZXNTdG9wOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RW5hYmxlZCghZGlzYWJsZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBrby51dGlscy5kb21Ob2RlRGlzcG9zYWwuYWRkRGlzcG9zZUNhbGxiYWNrKGVsZW1lbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5tdWx0aXNlbGVjdCgnZGVzdHJveScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5ncywgdmlld01vZGVsLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IGtvLnRvSlModmFsdWVBY2Nlc3NvcigpKTtcblxuICAgICAgICAgICAgICAgICRlbGVtZW50Lm11bHRpc2VsZWN0KCdzZXRPcHRpb25zJywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5tdWx0aXNlbGVjdCgncmVidWlsZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvckVhY2goYXJyYXksIGNhbGxiYWNrKSB7XG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBhcnJheS5sZW5ndGg7ICsraW5kZXgpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGFycmF5W2luZGV4XSwgaW5kZXgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgdG8gY3JlYXRlIGEgbmV3IG11bHRpc2VsZWN0IHVzaW5nIHRoZSBnaXZlbiBzZWxlY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gc2VsZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7TXVsdGlzZWxlY3R9XG4gICAgICovXG4gICAgZnVuY3Rpb24gTXVsdGlzZWxlY3Qoc2VsZWN0LCBvcHRpb25zKSB7XG5cbiAgICAgICAgdGhpcy4kc2VsZWN0ID0gJChzZWxlY3QpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSB0aGlzLm1lcmdlT3B0aW9ucygkLmV4dGVuZCh7fSwgb3B0aW9ucywgdGhpcy4kc2VsZWN0LmRhdGEoKSkpO1xuXG4gICAgICAgIC8vIFBsYWNlaG9sZGVyIHZpYSBkYXRhIGF0dHJpYnV0ZXNcbiAgICAgICAgaWYgKHRoaXMuJHNlbGVjdC5hdHRyKFwiZGF0YS1wbGFjZWhvbGRlclwiKSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm5vblNlbGVjdGVkVGV4dCA9IHRoaXMuJHNlbGVjdC5kYXRhKFwicGxhY2Vob2xkZXJcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJbml0aWFsaXphdGlvbi5cbiAgICAgICAgLy8gV2UgaGF2ZSB0byBjbG9uZSB0byBjcmVhdGUgYSBuZXcgcmVmZXJlbmNlLlxuICAgICAgICB0aGlzLm9yaWdpbmFsT3B0aW9ucyA9IHRoaXMuJHNlbGVjdC5jbG9uZSgpWzBdLm9wdGlvbnM7XG4gICAgICAgIHRoaXMucXVlcnkgPSAnJztcbiAgICAgICAgdGhpcy5zZWFyY2hUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5sYXN0VG9nZ2xlZElucHV0ID0gbnVsbDtcblxuICAgICAgICB0aGlzLm9wdGlvbnMubXVsdGlwbGUgPSB0aGlzLiRzZWxlY3QuYXR0cignbXVsdGlwbGUnKSA9PT0gXCJtdWx0aXBsZVwiO1xuICAgICAgICB0aGlzLm9wdGlvbnMub25DaGFuZ2UgPSAkLnByb3h5KHRoaXMub3B0aW9ucy5vbkNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHRoaXMub3B0aW9ucy5vblNlbGVjdEFsbCA9ICQucHJveHkodGhpcy5vcHRpb25zLm9uU2VsZWN0QWxsLCB0aGlzKTtcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uRGVzZWxlY3RBbGwgPSAkLnByb3h5KHRoaXMub3B0aW9ucy5vbkRlc2VsZWN0QWxsLCB0aGlzKTtcbiAgICAgICAgdGhpcy5vcHRpb25zLm9uRHJvcGRvd25TaG93ID0gJC5wcm94eSh0aGlzLm9wdGlvbnMub25Ecm9wZG93blNob3csIHRoaXMpO1xuICAgICAgICB0aGlzLm9wdGlvbnMub25Ecm9wZG93bkhpZGUgPSAkLnByb3h5KHRoaXMub3B0aW9ucy5vbkRyb3Bkb3duSGlkZSwgdGhpcyk7XG4gICAgICAgIHRoaXMub3B0aW9ucy5vbkRyb3Bkb3duU2hvd24gPSAkLnByb3h5KHRoaXMub3B0aW9ucy5vbkRyb3Bkb3duU2hvd24sIHRoaXMpO1xuICAgICAgICB0aGlzLm9wdGlvbnMub25Ecm9wZG93bkhpZGRlbiA9ICQucHJveHkodGhpcy5vcHRpb25zLm9uRHJvcGRvd25IaWRkZW4sIHRoaXMpO1xuICAgICAgICB0aGlzLm9wdGlvbnMub25Jbml0aWFsaXplZCA9ICQucHJveHkodGhpcy5vcHRpb25zLm9uSW5pdGlhbGl6ZWQsIHRoaXMpO1xuICAgICAgICB0aGlzLm9wdGlvbnMub25GaWx0ZXJpbmcgPSAkLnByb3h5KHRoaXMub3B0aW9ucy5vbkZpbHRlcmluZywgdGhpcyk7XG5cbiAgICAgICAgLy8gQnVpbGQgc2VsZWN0IGFsbCBpZiBlbmFibGVkLlxuICAgICAgICB0aGlzLmJ1aWxkQ29udGFpbmVyKCk7XG4gICAgICAgIHRoaXMuYnVpbGRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5idWlsZERyb3Bkb3duKCk7XG4gICAgICAgIHRoaXMuYnVpbGRSZXNldCgpO1xuICAgICAgICB0aGlzLmJ1aWxkU2VsZWN0QWxsKCk7XG4gICAgICAgIHRoaXMuYnVpbGREcm9wZG93bk9wdGlvbnMoKTtcbiAgICAgICAgdGhpcy5idWlsZEZpbHRlcigpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlQnV0dG9uVGV4dCgpO1xuICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdEFsbCh0cnVlKTtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNsaWNrYWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlT3B0R3JvdXBzKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm9wdGlvbnMud2FzRGlzYWJsZWQgPSB0aGlzLiRzZWxlY3QucHJvcCgnZGlzYWJsZWQnKTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXNhYmxlSWZFbXB0eSAmJiAkKCdvcHRpb24nLCB0aGlzLiRzZWxlY3QpLmxlbmd0aCA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuJHNlbGVjdC53cmFwKCc8c3BhbiBjbGFzcz1cIm11bHRpc2VsZWN0LW5hdGl2ZS1zZWxlY3RcIiAvPicpLmFmdGVyKHRoaXMuJGNvbnRhaW5lcik7XG4gICAgICAgIHRoaXMub3B0aW9ucy5vbkluaXRpYWxpemVkKHRoaXMuJHNlbGVjdCwgdGhpcy4kY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBNdWx0aXNlbGVjdC5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRGVmYXVsdCB0ZXh0IGZ1bmN0aW9uIHdpbGwgZWl0aGVyIHByaW50ICdOb25lIHNlbGVjdGVkJyBpbiBjYXNlIG5vXG4gICAgICAgICAgICAgKiBvcHRpb24gaXMgc2VsZWN0ZWQgb3IgYSBsaXN0IG9mIHRoZSBzZWxlY3RlZCBvcHRpb25zIHVwIHRvIGEgbGVuZ3RoXG4gICAgICAgICAgICAgKiBvZiAzIHNlbGVjdGVkIG9wdGlvbnMuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9IG9wdGlvbnNcbiAgICAgICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSBzZWxlY3RcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGJ1dHRvblRleHQ6IGZ1bmN0aW9uKG9wdGlvbnMsIHNlbGVjdCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRpc2FibGVkVGV4dC5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgICAgICYmIChzZWxlY3QucHJvcCgnZGlzYWJsZWQnKSB8fCAob3B0aW9ucy5sZW5ndGggPT0gMCAmJiB0aGlzLmRpc2FibGVJZkVtcHR5KSkpICB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWRUZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ub25TZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuYWxsU2VsZWN0ZWRUZXh0XG4gICAgICAgICAgICAgICAgICAgICYmIG9wdGlvbnMubGVuZ3RoID09PSAkKCdvcHRpb24nLCAkKHNlbGVjdCkpLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAmJiAkKCdvcHRpb24nLCAkKHNlbGVjdCkpLmxlbmd0aCAhPT0gMVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLm11bHRpcGxlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0QWxsTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hbGxTZWxlY3RlZFRleHQgKyAnICgnICsgb3B0aW9ucy5sZW5ndGggKyAnKSc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hbGxTZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5udW1iZXJEaXNwbGF5ZWQgIT0gMCAmJiBvcHRpb25zLmxlbmd0aCA+IHRoaXMubnVtYmVyRGlzcGxheWVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpb25zLmxlbmd0aCArICcgJyArIHRoaXMublNlbGVjdGVkVGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVsaW1pdGVyID0gdGhpcy5kZWxpbWl0ZXJUZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9ICgkKHRoaXMpLmF0dHIoJ2xhYmVsJykgIT09IHVuZGVmaW5lZCkgPyAkKHRoaXMpLmF0dHIoJ2xhYmVsJykgOiAkKHRoaXMpLnRleHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkICs9IGxhYmVsICsgZGVsaW1pdGVyO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWQuc3Vic3RyKDAsIHNlbGVjdGVkLmxlbmd0aCAtIHRoaXMuZGVsaW1pdGVyVGV4dC5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFVwZGF0ZXMgdGhlIHRpdGxlIG9mIHRoZSBidXR0b24gc2ltaWxhciB0byB0aGUgYnV0dG9uVGV4dCBmdW5jdGlvbi5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeX0gb3B0aW9uc1xuICAgICAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9IHNlbGVjdFxuICAgICAgICAgICAgICogQHJldHVybnMge0BleHA7c2VsZWN0ZWRAY2FsbDtzdWJzdHJ9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGJ1dHRvblRpdGxlOiBmdW5jdGlvbihvcHRpb25zLCBzZWxlY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubm9uU2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWxpbWl0ZXIgPSB0aGlzLmRlbGltaXRlclRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9ICgkKHRoaXMpLmF0dHIoJ2xhYmVsJykgIT09IHVuZGVmaW5lZCkgPyAkKHRoaXMpLmF0dHIoJ2xhYmVsJykgOiAkKHRoaXMpLnRleHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkICs9IGxhYmVsICsgZGVsaW1pdGVyO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkLnN1YnN0cigwLCBzZWxlY3RlZC5sZW5ndGggLSB0aGlzLmRlbGltaXRlclRleHQubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2hlY2tib3hOYW1lOiBmdW5jdGlvbihvcHRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIG5vIGNoZWNrYm94IG5hbWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENyZWF0ZSBhIGxhYmVsLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSBlbGVtZW50XG4gICAgICAgICAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvcHRpb25MYWJlbDogZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICQoZWxlbWVudCkuYXR0cignbGFiZWwnKSB8fCAkKGVsZW1lbnQpLnRleHQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENyZWF0ZSBhIGNsYXNzLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSBlbGVtZW50XG4gICAgICAgICAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvcHRpb25DbGFzczogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAkKGVsZW1lbnQpLmF0dHIoJ2NsYXNzJykgfHwgJyc7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyZWQgb24gY2hhbmdlIG9mIHRoZSBtdWx0aXNlbGVjdC5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBOb3QgdHJpZ2dlcmVkIHdoZW4gc2VsZWN0aW5nL2Rlc2VsZWN0aW5nIG9wdGlvbnMgbWFudWFsbHkuXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9IG9wdGlvblxuICAgICAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBjaGVja2VkXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uQ2hhbmdlIDogZnVuY3Rpb24ob3B0aW9uLCBjaGVja2VkKSB7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJlZCB3aGVuIHRoZSBkcm9wZG93biBpcyBzaG93bi5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeX0gZXZlbnRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25Ecm9wZG93blNob3c6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJlZCB3aGVuIHRoZSBkcm9wZG93biBpcyBoaWRkZW4uXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9IGV2ZW50XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uRHJvcGRvd25IaWRlOiBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyZWQgYWZ0ZXIgdGhlIGRyb3Bkb3duIGlzIHNob3duLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSBldmVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbkRyb3Bkb3duU2hvd246IGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRyaWdnZXJlZCBhZnRlciB0aGUgZHJvcGRvd24gaXMgaGlkZGVuLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSBldmVudFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbkRyb3Bkb3duSGlkZGVuOiBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyZWQgb24gc2VsZWN0IGFsbC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25TZWxlY3RBbGw6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyZWQgb24gZGVzZWxlY3QgYWxsLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbkRlc2VsZWN0QWxsOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVHJpZ2dlcmVkIGFmdGVyIGluaXRpYWxpemluZy5cbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJHNlbGVjdFxuICAgICAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9ICRjb250YWluZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25Jbml0aWFsaXplZDogZnVuY3Rpb24oJHNlbGVjdCwgJGNvbnRhaW5lcikge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUcmlnZ2VyZWQgb24gZmlsdGVyaW5nLlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkZmlsdGVyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uRmlsdGVyaW5nOiBmdW5jdGlvbigkZmlsdGVyKSB7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbmFibGVIVE1MOiBmYWxzZSxcbiAgICAgICAgICAgIGJ1dHRvbkNsYXNzOiAnYnRuIGJ0bi1kZWZhdWx0JyxcbiAgICAgICAgICAgIGluaGVyaXRDbGFzczogZmFsc2UsXG4gICAgICAgICAgICBidXR0b25XaWR0aDogJ2F1dG8nLFxuICAgICAgICAgICAgYnV0dG9uQ29udGFpbmVyOiAnPGRpdiBjbGFzcz1cImJ0bi1ncm91cFwiIC8+JyxcbiAgICAgICAgICAgIGRyb3BSaWdodDogZmFsc2UsXG4gICAgICAgICAgICBkcm9wVXA6IGZhbHNlLFxuICAgICAgICAgICAgc2VsZWN0ZWRDbGFzczogJ2FjdGl2ZScsXG4gICAgICAgICAgICAvLyBNYXhpbXVtIGhlaWdodCBvZiB0aGUgZHJvcGRvd24gbWVudS5cbiAgICAgICAgICAgIC8vIElmIG1heGltdW0gaGVpZ2h0IGlzIGV4Y2VlZGVkIGEgc2Nyb2xsYmFyIHdpbGwgYmUgZGlzcGxheWVkLlxuICAgICAgICAgICAgbWF4SGVpZ2h0OiBmYWxzZSxcbiAgICAgICAgICAgIGluY2x1ZGVTZWxlY3RBbGxPcHRpb246IGZhbHNlLFxuICAgICAgICAgICAgaW5jbHVkZVNlbGVjdEFsbElmTW9yZVRoYW46IDAsXG4gICAgICAgICAgICBzZWxlY3RBbGxUZXh0OiAnINCS0YHQtScsXG4gICAgICAgICAgICBzZWxlY3RBbGxWYWx1ZTogJ211bHRpc2VsZWN0LWFsbCcsXG4gICAgICAgICAgICBzZWxlY3RBbGxOYW1lOiBmYWxzZSxcbiAgICAgICAgICAgIHNlbGVjdEFsbE51bWJlcjogdHJ1ZSxcbiAgICAgICAgICAgIHNlbGVjdEFsbEp1c3RWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIGVuYWJsZUNhc2VJbnNlbnNpdGl2ZUZpbHRlcmluZzogZmFsc2UsXG4gICAgICAgICAgICBlbmFibGVGdWxsVmFsdWVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgZW5hYmxlQ2xpY2thYmxlT3B0R3JvdXBzOiBmYWxzZSxcbiAgICAgICAgICAgIGVuYWJsZUNvbGxhcHNpYmxlT3B0R3JvdXBzOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbGxhcHNlT3B0R3JvdXBzQnlEZWZhdWx0OiBmYWxzZSxcbiAgICAgICAgICAgIGZpbHRlclBsYWNlaG9sZGVyOiAnU2VhcmNoJyxcbiAgICAgICAgICAgIC8vIHBvc3NpYmxlIG9wdGlvbnM6ICd0ZXh0JywgJ3ZhbHVlJywgJ2JvdGgnXG4gICAgICAgICAgICBmaWx0ZXJCZWhhdmlvcjogJ3RleHQnLFxuICAgICAgICAgICAgaW5jbHVkZUZpbHRlckNsZWFyQnRuOiB0cnVlLFxuICAgICAgICAgICAgcHJldmVudElucHV0Q2hhbmdlRXZlbnQ6IGZhbHNlLFxuICAgICAgICAgICAgbm9uU2VsZWN0ZWRUZXh0OiAn0JLRi9Cx0YDQsNGC0YwnLFxuICAgICAgICAgICAgblNlbGVjdGVkVGV4dDogJ3NlbGVjdGVkJyxcbiAgICAgICAgICAgIGFsbFNlbGVjdGVkVGV4dDogJ0FsbCBzZWxlY3RlZCcsXG4gICAgICAgICAgICBudW1iZXJEaXNwbGF5ZWQ6IDMsXG4gICAgICAgICAgICBkaXNhYmxlSWZFbXB0eTogZmFsc2UsXG4gICAgICAgICAgICBkaXNhYmxlZFRleHQ6ICcnLFxuICAgICAgICAgICAgZGVsaW1pdGVyVGV4dDogJywgJyxcbiAgICAgICAgICAgIGluY2x1ZGVSZXNldE9wdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBpbmNsdWRlUmVzZXREaXZpZGVyOiBmYWxzZSxcbiAgICAgICAgICAgIHJlc2V0VGV4dDogJ1Jlc2V0JyxcbiAgICAgICAgICAgIHRlbXBsYXRlczoge1xuICAgICAgICAgICAgICAgIGJ1dHRvbjogJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwibXVsdGlzZWxlY3QgZHJvcGRvd24tdG9nZ2xlXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiPjxzcGFuIGNsYXNzPVwibXVsdGlzZWxlY3Qtc2VsZWN0ZWQtdGV4dFwiPjwvc3Bhbj4gPGIgY2xhc3M9XCJjYXJldFwiPjwvYj48L2J1dHRvbj4nLFxuICAgICAgICAgICAgICAgIHVsOiAnPHVsIGNsYXNzPVwibXVsdGlzZWxlY3QtY29udGFpbmVyIGRyb3Bkb3duLW1lbnVcIj48L3VsPicsXG4gICAgICAgICAgICAgICAgZmlsdGVyOiAnPGxpIGNsYXNzPVwibXVsdGlzZWxlY3QtaXRlbSBtdWx0aXNlbGVjdC1maWx0ZXJcIj48ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXBcIj48c3BhbiBjbGFzcz1cImlucHV0LWdyb3VwLWFkZG9uXCI+PGkgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXNlYXJjaFwiPjwvaT48L3NwYW4+PGlucHV0IGNsYXNzPVwiZm9ybS1jb250cm9sIG11bHRpc2VsZWN0LXNlYXJjaFwiIHR5cGU9XCJ0ZXh0XCIgLz48L2Rpdj48L2xpPicsXG4gICAgICAgICAgICAgICAgZmlsdGVyQ2xlYXJCdG46ICc8c3BhbiBjbGFzcz1cImlucHV0LWdyb3VwLWJ0blwiPjxidXR0b24gY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgbXVsdGlzZWxlY3QtY2xlYXItZmlsdGVyXCIgdHlwZT1cImJ1dHRvblwiPjxpIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUtY2lyY2xlXCI+PC9pPjwvYnV0dG9uPjwvc3Bhbj4nLFxuICAgICAgICAgICAgICAgIGxpOiAnPGxpPjxhIHRhYmluZGV4PVwiMFwiPjxsYWJlbD48L2xhYmVsPjwvYT48L2xpPicsXG4gICAgICAgICAgICAgICAgZGl2aWRlcjogJzxsaSBjbGFzcz1cIm11bHRpc2VsZWN0LWl0ZW0gZGl2aWRlclwiPjwvbGk+JyxcbiAgICAgICAgICAgICAgICBsaUdyb3VwOiAnPGxpIGNsYXNzPVwibXVsdGlzZWxlY3QtaXRlbSBtdWx0aXNlbGVjdC1ncm91cFwiPjxsYWJlbD48L2xhYmVsPjwvbGk+JyxcbiAgICAgICAgICAgICAgICByZXNldEJ1dHRvbjogJzxsaSBjbGFzcz1cIm11bHRpc2VsZWN0LXJlc2V0IHRleHQtY2VudGVyXCI+PGRpdiBjbGFzcz1cImlucHV0LWdyb3VwXCI+PGEgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLWJsb2NrXCI+PC9hPjwvZGl2PjwvbGk+J1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGNvbnN0cnVjdG9yOiBNdWx0aXNlbGVjdCxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQnVpbGRzIHRoZSBjb250YWluZXIgb2YgdGhlIG11bHRpc2VsZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgYnVpbGRDb250YWluZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy4kY29udGFpbmVyID0gJCh0aGlzLm9wdGlvbnMuYnV0dG9uQ29udGFpbmVyKTtcbiAgICAgICAgICAgIHRoaXMuJGNvbnRhaW5lci5vbignc2hvdy5icy5kcm9wZG93bicsIHRoaXMub3B0aW9ucy5vbkRyb3Bkb3duU2hvdyk7XG4gICAgICAgICAgICB0aGlzLiRjb250YWluZXIub24oJ2hpZGUuYnMuZHJvcGRvd24nLCB0aGlzLm9wdGlvbnMub25Ecm9wZG93bkhpZGUpO1xuICAgICAgICAgICAgdGhpcy4kY29udGFpbmVyLm9uKCdzaG93bi5icy5kcm9wZG93bicsIHRoaXMub3B0aW9ucy5vbkRyb3Bkb3duU2hvd24pO1xuICAgICAgICAgICAgdGhpcy4kY29udGFpbmVyLm9uKCdoaWRkZW4uYnMuZHJvcGRvd24nLCB0aGlzLm9wdGlvbnMub25Ecm9wZG93bkhpZGRlbik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJ1aWxkcyB0aGUgYnV0dG9uIG9mIHRoZSBtdWx0aXNlbGVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGJ1aWxkQnV0dG9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuJGJ1dHRvbiA9ICQodGhpcy5vcHRpb25zLnRlbXBsYXRlcy5idXR0b24pLmFkZENsYXNzKHRoaXMub3B0aW9ucy5idXR0b25DbGFzcyk7XG4gICAgICAgICAgICBpZiAodGhpcy4kc2VsZWN0LmF0dHIoJ2NsYXNzJykgJiYgdGhpcy5vcHRpb25zLmluaGVyaXRDbGFzcykge1xuICAgICAgICAgICAgICAgIHRoaXMuJGJ1dHRvbi5hZGRDbGFzcyh0aGlzLiRzZWxlY3QuYXR0cignY2xhc3MnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBZG9wdCBhY3RpdmUgc3RhdGUuXG4gICAgICAgICAgICBpZiAodGhpcy4kc2VsZWN0LnByb3AoJ2Rpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE1hbnVhbGx5IGFkZCBidXR0b24gd2lkdGggaWYgc2V0LlxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5idXR0b25XaWR0aCAmJiB0aGlzLm9wdGlvbnMuYnV0dG9uV2lkdGggIT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgIHRoaXMuJGJ1dHRvbi5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAnd2lkdGgnIDogJzEwMCUnLCAvL3RoaXMub3B0aW9ucy5idXR0b25XaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93JyA6ICdoaWRkZW4nLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1vdmVyZmxvdycgOiAnZWxsaXBzaXMnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy4kY29udGFpbmVyLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICd3aWR0aCc6IHRoaXMub3B0aW9ucy5idXR0b25XaWR0aFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBLZWVwIHRoZSB0YWIgaW5kZXggZnJvbSB0aGUgc2VsZWN0LlxuICAgICAgICAgICAgdmFyIHRhYmluZGV4ID0gdGhpcy4kc2VsZWN0LmF0dHIoJ3RhYmluZGV4Jyk7XG4gICAgICAgICAgICBpZiAodGFiaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLiRidXR0b24uYXR0cigndGFiaW5kZXgnLCB0YWJpbmRleCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuJGNvbnRhaW5lci5wcmVwZW5kKHRoaXMuJGJ1dHRvbik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJ1aWxkcyB0aGUgdWwgcmVwcmVzZW50aW5nIHRoZSBkcm9wZG93biBtZW51LlxuICAgICAgICAgKi9cbiAgICAgICAgYnVpbGREcm9wZG93bjogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIC8vIEJ1aWxkIHVsLlxuICAgICAgICAgICAgdGhpcy4kdWwgPSAkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZXMudWwpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRyb3BSaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuJHVsLmFkZENsYXNzKCdwdWxsLXJpZ2h0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCBtYXggaGVpZ2h0IG9mIGRyb3Bkb3duIG1lbnUgdG8gYWN0aXZhdGUgYXV0byBzY3JvbGxiYXIuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLm1heEhlaWdodCkge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IEFkZCBhIGNsYXNzIGZvciB0aGlzIG9wdGlvbiB0byBtb3ZlIHRoZSBjc3MgZGVjbGFyYXRpb25zLlxuICAgICAgICAgICAgICAgIHRoaXMuJHVsLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICdtYXgtaGVpZ2h0JzogdGhpcy5vcHRpb25zLm1heEhlaWdodCArICdweCcsXG4gICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdy15JzogJ2F1dG8nLFxuICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cteCc6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZHJvcFVwKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gTWF0aC5taW4odGhpcy5vcHRpb25zLm1heEhlaWdodCwgJCgnb3B0aW9uW2RhdGEtcm9sZSE9XCJkaXZpZGVyXCJdJywgdGhpcy4kc2VsZWN0KS5sZW5ndGgqMjYgKyAkKCdvcHRpb25bZGF0YS1yb2xlPVwiZGl2aWRlclwiXScsIHRoaXMuJHNlbGVjdCkubGVuZ3RoKjE5ICsgKHRoaXMub3B0aW9ucy5pbmNsdWRlU2VsZWN0QWxsT3B0aW9uID8gMjYgOiAwKSArICh0aGlzLm9wdGlvbnMuZW5hYmxlRmlsdGVyaW5nIHx8IHRoaXMub3B0aW9ucy5lbmFibGVDYXNlSW5zZW5zaXRpdmVGaWx0ZXJpbmcgPyA0NCA6IDApKTtcbiAgICAgICAgICAgICAgICB2YXIgbW92ZUNhbGMgPSBoZWlnaHQgKyAzNDtcblxuICAgICAgICAgICAgICAgIHRoaXMuJHVsLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICdtYXgtaGVpZ2h0JzogaGVpZ2h0ICsgJ3B4JyxcbiAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93LXknOiAnYXV0bycsXG4gICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdy14JzogJ2hpZGRlbicsXG4gICAgICAgICAgICAgICAgICAgICdtYXJnaW4tdG9wJzogXCItXCIgKyBtb3ZlQ2FsYyArICdweCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy4kY29udGFpbmVyLmFwcGVuZCh0aGlzLiR1bCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJ1aWxkIHRoZSBkcm9wZG93biBvcHRpb25zIGFuZCBiaW5kcyBhbGwgbmVjZXNzYXJ5IGV2ZW50cy5cbiAgICAgICAgICpcbiAgICAgICAgICogVXNlcyBjcmVhdGVEaXZpZGVyIGFuZCBjcmVhdGVPcHRpb25WYWx1ZSB0byBjcmVhdGUgdGhlIG5lY2Vzc2FyeSBvcHRpb25zLlxuICAgICAgICAgKi9cbiAgICAgICAgYnVpbGREcm9wZG93bk9wdGlvbnM6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB0aGlzLiRzZWxlY3QuY2hpbGRyZW4oKS5lYWNoKCQucHJveHkoZnVuY3Rpb24oaW5kZXgsIGVsZW1lbnQpIHtcblxuICAgICAgICAgICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgLy8gU3VwcG9ydCBvcHRncm91cHMgYW5kIG9wdGlvbnMgd2l0aG91dCBhIGdyb3VwIHNpbXVsdGFuZW91c2x5LlxuICAgICAgICAgICAgICAgIHZhciB0YWcgPSAkZWxlbWVudC5wcm9wKCd0YWdOYW1lJylcbiAgICAgICAgICAgICAgICAgICAgLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoJGVsZW1lbnQucHJvcCgndmFsdWUnKSA9PT0gdGhpcy5vcHRpb25zLnNlbGVjdEFsbFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGFnID09PSAnb3B0Z3JvdXAnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlT3B0Z3JvdXAoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRhZyA9PT0gJ29wdGlvbicpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJGVsZW1lbnQuZGF0YSgncm9sZScpID09PSAnZGl2aWRlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRGl2aWRlcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVPcHRpb25WYWx1ZShlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gT3RoZXIgaWxsZWdhbCB0YWdzIHdpbGwgYmUgaWdub3JlZC5cbiAgICAgICAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgICAgICAgLy8gQmluZCB0aGUgY2hhbmdlIGV2ZW50IG9uIHRoZSBkcm9wZG93biBlbGVtZW50cy5cbiAgICAgICAgICAgICQodGhpcy4kdWwpLm9mZignY2hhbmdlJywgJ2xpOm5vdCgubXVsdGlzZWxlY3QtZ3JvdXApIGlucHV0W3R5cGU9XCJjaGVja2JveFwiXSwgbGk6bm90KC5tdWx0aXNlbGVjdC1ncm91cCkgaW5wdXRbdHlwZT1cInJhZGlvXCJdJyk7XG4gICAgICAgICAgICAkKHRoaXMuJHVsKS5vbignY2hhbmdlJywgJ2xpOm5vdCgubXVsdGlzZWxlY3QtZ3JvdXApIGlucHV0W3R5cGU9XCJjaGVja2JveFwiXSwgbGk6bm90KC5tdWx0aXNlbGVjdC1ncm91cCkgaW5wdXRbdHlwZT1cInJhZGlvXCJdJywgJC5wcm94eShmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJChldmVudC50YXJnZXQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSAkdGFyZ2V0LnByb3AoJ2NoZWNrZWQnKSB8fCBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgaXNTZWxlY3RBbGxPcHRpb24gPSAkdGFyZ2V0LnZhbCgpID09PSB0aGlzLm9wdGlvbnMuc2VsZWN0QWxsVmFsdWU7XG5cbiAgICAgICAgICAgICAgICAvLyBBcHBseSBvciB1bmFwcGx5IHRoZSBjb25maWd1cmVkIHNlbGVjdGVkIGNsYXNzLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldC5jbG9zZXN0KCdsaScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0YXJnZXQuY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIGNvcnJlc3BvbmRpbmcgb3B0aW9uLlxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICR0YXJnZXQudmFsKCk7XG4gICAgICAgICAgICAgICAgdmFyICRvcHRpb24gPSB0aGlzLmdldE9wdGlvbkJ5VmFsdWUodmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgdmFyICRvcHRpb25zTm90VGhpcyA9ICQoJ29wdGlvbicsIHRoaXMuJHNlbGVjdCkubm90KCRvcHRpb24pO1xuICAgICAgICAgICAgICAgIHZhciAkY2hlY2tib3hlc05vdFRoaXMgPSAkKCdpbnB1dCcsIHRoaXMuJGNvbnRhaW5lcikubm90KCR0YXJnZXQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzU2VsZWN0QWxsT3B0aW9uKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0QWxsKHRoaXMub3B0aW9ucy5zZWxlY3RBbGxKdXN0VmlzaWJsZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlc2VsZWN0QWxsKHRoaXMub3B0aW9ucy5zZWxlY3RBbGxKdXN0VmlzaWJsZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTaW1wbHkgc2VsZWN0IGFkZGl0aW9uYWwgb3B0aW9uLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVuc2VsZWN0IGFsbCBvdGhlciBvcHRpb25zIGFuZCBjb3JyZXNwb25kaW5nIGNoZWNrYm94ZXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJGNoZWNrYm94ZXNOb3RUaGlzKS5jbG9zZXN0KCdsaScpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCRjaGVja2JveGVzTm90VGhpcykucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkb3B0aW9uc05vdFRoaXMucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJdCdzIGEgc2luZ2xlIHNlbGVjdGlvbiwgc28gY2xvc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kYnV0dG9uLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyA9PT0gXCJhY3RpdmVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvcHRpb25zTm90VGhpcy5jbG9zZXN0KFwiYVwiKS5jc3MoXCJvdXRsaW5lXCIsIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVW5zZWxlY3Qgb3B0aW9uLlxuICAgICAgICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRvIHByZXZlbnQgc2VsZWN0IGFsbCBmcm9tIGZpcmluZyBvbkNoYW5nZTogIzU3NVxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25DaGFuZ2UoJG9wdGlvbiwgY2hlY2tlZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90IHVwZGF0ZSBzZWxlY3QgYWxsIG9yIG9wdGdyb3VwcyBvbiBzZWxlY3QgYWxsIGNoYW5nZSFcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RBbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNsaWNrYWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlT3B0R3JvdXBzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLiRzZWxlY3QuY2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVCdXR0b25UZXh0KCk7XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLm9wdGlvbnMucHJldmVudElucHV0Q2hhbmdlRXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgICAgICAgJCgnbGkgYScsIHRoaXMuJHVsKS5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgc2VsZWN0aW5nIHRleHQgYnkgU2hpZnQrY2xpY2tcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKHRoaXMuJHVsKS5vbigndG91Y2hzdGFydCBjbGljaycsICdsaSBhJywgJC5wcm94eShmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuc2hpZnRLZXkgJiYgdGhpcy5vcHRpb25zLm11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKCR0YXJnZXQuaXMoXCJsYWJlbFwiKSl7IC8vIEhhbmRsZXMgY2hlY2tib3ggc2VsZWN0aW9uIG1hbnVhbGx5IChzZWUgaHR0cHM6Ly9naXRodWIuY29tL2Rhdmlkc3R1dHovYm9vdHN0cmFwLW11bHRpc2VsZWN0L2lzc3Vlcy80MzEpXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldCA9ICR0YXJnZXQuZmluZChcImlucHV0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldC5wcm9wKFwiY2hlY2tlZFwiLCAhJHRhcmdldC5wcm9wKFwiY2hlY2tlZFwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSAkdGFyZ2V0LnByb3AoJ2NoZWNrZWQnKSB8fCBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sYXN0VG9nZ2xlZElucHV0ICE9PSBudWxsICYmIHRoaXMubGFzdFRvZ2dsZWRJbnB1dCAhPT0gJHRhcmdldCkgeyAvLyBNYWtlIHN1cmUgd2UgYWN0dWFsbHkgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IHRoaXMuJHVsLmZpbmQoXCJsaTp2aXNpYmxlXCIpLmluZGV4KCR0YXJnZXQucGFyZW50cyhcImxpXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0byA9IHRoaXMuJHVsLmZpbmQoXCJsaTp2aXNpYmxlXCIpLmluZGV4KHRoaXMubGFzdFRvZ2dsZWRJbnB1dC5wYXJlbnRzKFwibGlcIikpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnJvbSA+IHRvKSB7IC8vIFN3YXAgdGhlIGluZGljZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gdG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gPSBmcm9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gPSB0bXA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBncmFiIGFsbCBlbGVtZW50cyBzaW5jZSBzbGljZSBleGNsdWRlcyB0aGUgbGFzdCBpbmRleFxuICAgICAgICAgICAgICAgICAgICAgICAgKyt0bztcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hhbmdlIHRoZSBjaGVja2JveGVzIGFuZCB1bmRlcmx5aW5nIG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuJHVsLmZpbmQoXCJsaVwiKS5ub3QoXCIubXVsdGlzZWxlY3QtZmlsdGVyLWhpZGRlblwiKS5zbGljZShmcm9tLCB0bykuZmluZChcImlucHV0XCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5wcm9wKCdjaGVja2VkJywgY2hlY2tlZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLmNsb3Nlc3QoJ2xpJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvZ2dsZUNsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzLCBjaGVja2VkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSByYW5nZS5sZW5ndGg7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGNoZWNrYm94ID0gJChyYW5nZVtpXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG9wdGlvbiA9IHRoaXMuZ2V0T3B0aW9uQnlWYWx1ZSgkY2hlY2tib3gudmFsKCkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIGNoZWNrZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVHJpZ2dlciB0aGUgc2VsZWN0IFwiY2hhbmdlXCIgZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgJHRhcmdldC50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFJlbWVtYmVycyBsYXN0IGNsaWNrZWQgb3B0aW9uXG4gICAgICAgICAgICAgICAgaWYoJHRhcmdldC5pcyhcImlucHV0XCIpICYmICEkdGFyZ2V0LmNsb3Nlc3QoXCJsaVwiKS5pcyhcIi5tdWx0aXNlbGVjdC1pdGVtXCIpKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0VG9nZ2xlZElucHV0ID0gJHRhcmdldDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkdGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgICAgICAgLy8gS2V5Ym9hcmQgc3VwcG9ydC5cbiAgICAgICAgICAgIHRoaXMuJGNvbnRhaW5lci5vZmYoJ2tleWRvd24ubXVsdGlzZWxlY3QnKS5vbigna2V5ZG93bi5tdWx0aXNlbGVjdCcsICQucHJveHkoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoJCgnaW5wdXRbdHlwZT1cInRleHRcIl0nLCB0aGlzLiRjb250YWluZXIpLmlzKCc6Zm9jdXMnKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDkgJiYgdGhpcy4kY29udGFpbmVyLmhhc0NsYXNzKCdvcGVuJykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kYnV0dG9uLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGl0ZW1zID0gJCh0aGlzLiRjb250YWluZXIpLmZpbmQoXCJsaTpub3QoLmRpdmlkZXIpOm5vdCguZGlzYWJsZWQpIGFcIikuZmlsdGVyKFwiOnZpc2libGVcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAkaXRlbXMuaW5kZXgoJGl0ZW1zLmZpbHRlcignOmZvY3VzJykpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIE5hdmlnYXRpb24gdXAuXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzOCAmJiBpbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LS07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gTmF2aWdhdGUgZG93bi5cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gNDAgJiYgaW5kZXggPCAkaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghfmluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgJGN1cnJlbnQgPSAkaXRlbXMuZXEoaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAkY3VycmVudC5mb2N1cygpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzMiB8fCBldmVudC5rZXlDb2RlID09PSAxMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRjaGVja2JveCA9ICRjdXJyZW50LmZpbmQoJ2lucHV0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICRjaGVja2JveC5wcm9wKFwiY2hlY2tlZFwiLCAhJGNoZWNrYm94LnByb3AoXCJjaGVja2VkXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRjaGVja2JveC5jaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmFibGVDbGlja2FibGVPcHRHcm91cHMgJiYgdGhpcy5vcHRpb25zLm11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgJChcImxpLm11bHRpc2VsZWN0LWdyb3VwIGlucHV0XCIsIHRoaXMuJHVsKS5vbihcImNoYW5nZVwiLCAkLnByb3h5KGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciAkdGFyZ2V0ID0gJChldmVudC50YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tlZCA9ICR0YXJnZXQucHJvcCgnY2hlY2tlZCcpIHx8IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciAkbGkgPSAkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgnbGknKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRncm91cCA9ICRsaS5uZXh0VW50aWwoXCJsaS5tdWx0aXNlbGVjdC1ncm91cFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm5vdCgnLm11bHRpc2VsZWN0LWZpbHRlci1oaWRkZW4nKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm5vdCgnLmRpc2FibGVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyICRpbnB1dHMgPSAkZ3JvdXAuZmluZChcImlucHV0XCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRvcHRpb25zID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsaS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGkucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCRpbnB1dHMsICQucHJveHkoZnVuY3Rpb24oaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSAkKGlucHV0KS52YWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkb3B0aW9uID0gdGhpcy5nZXRPcHRpb25CeVZhbHVlKHZhbHVlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGlucHV0KS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChpbnB1dCkuY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChpbnB1dCkucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGlucHV0KS5jbG9zZXN0KCdsaScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAkb3B0aW9ucy5wdXNoKHRoaXMuZ2V0T3B0aW9uQnlWYWx1ZSh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSlcblxuICAgICAgICAgICAgICAgICAgICAvLyBDYW5ub3QgdXNlIHNlbGVjdCBvciBkZXNlbGVjdCBoZXJlIGJlY2F1c2UgaXQgd291bGQgY2FsbCB1cGRhdGVPcHRHcm91cHMgYWdhaW4uXG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uQ2hhbmdlKCRvcHRpb25zLCBjaGVja2VkKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLiRzZWxlY3QuY2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQnV0dG9uVGV4dCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdEFsbCgpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmFibGVDb2xsYXBzaWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAkKFwibGkubXVsdGlzZWxlY3QtZ3JvdXAgLmNhcmV0LWNvbnRhaW5lclwiLCB0aGlzLiR1bCkub24oXCJjbGlja1wiLCAkLnByb3h5KGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkbGkgPSAkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgnbGknKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRpbnB1dHMgPSAkbGkubmV4dFVudGlsKFwibGkubXVsdGlzZWxlY3QtZ3JvdXBcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5ub3QoJy5tdWx0aXNlbGVjdC1maWx0ZXItaGlkZGVuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAkaW5wdXRzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlID0gdmlzaWJsZSAmJiAhJCh0aGlzKS5oYXNDbGFzcygnbXVsdGlzZWxlY3QtY29sbGFwc2libGUtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5wdXRzLmhpZGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnbXVsdGlzZWxlY3QtY29sbGFwc2libGUtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5wdXRzLnNob3coKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnbXVsdGlzZWxlY3QtY29sbGFwc2libGUtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCB0aGlzKSk7XG5cbiAgICAgICAgICAgICAgICAkKFwibGkubXVsdGlzZWxlY3QtYWxsXCIsIHRoaXMuJHVsKS5jc3MoJ2JhY2tncm91bmQnLCAnI2YzZjNmMycpLmNzcygnYm9yZGVyLWJvdHRvbScsICcxcHggc29saWQgI2VhZWFlYScpO1xuICAgICAgICAgICAgICAgICQoXCJsaS5tdWx0aXNlbGVjdC1hbGwgPiBhID4gbGFiZWwuY2hlY2tib3hcIiwgdGhpcy4kdWwpLmNzcygncGFkZGluZycsICczcHggMjBweCAzcHggMzVweCcpO1xuICAgICAgICAgICAgICAgICQoXCJsaS5tdWx0aXNlbGVjdC1ncm91cCA+IGEgPiBpbnB1dFwiLCB0aGlzLiR1bCkuY3NzKCdtYXJnaW4nLCAnNHB4IDBweCA1cHggLTIwcHgnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ3JlYXRlIGFuIG9wdGlvbiB1c2luZyB0aGUgZ2l2ZW4gc2VsZWN0IG9wdGlvbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9IGVsZW1lbnRcbiAgICAgICAgICovXG4gICAgICAgIGNyZWF0ZU9wdGlvblZhbHVlOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKCRlbGVtZW50LmlzKCc6c2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgICAgICRlbGVtZW50LnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN1cHBvcnQgdGhlIGxhYmVsIGF0dHJpYnV0ZSBvbiBvcHRpb25zLlxuICAgICAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5vcHRpb25zLm9wdGlvbkxhYmVsKGVsZW1lbnQpO1xuICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSB0aGlzLm9wdGlvbnMub3B0aW9uQ2xhc3MoZWxlbWVudCk7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAkZWxlbWVudC52YWwoKTtcbiAgICAgICAgICAgIHZhciBpbnB1dFR5cGUgPSB0aGlzLm9wdGlvbnMubXVsdGlwbGUgPyBcImNoZWNrYm94XCIgOiBcInJhZGlvXCI7XG5cbiAgICAgICAgICAgIHZhciAkbGkgPSAkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZXMubGkpO1xuICAgICAgICAgICAgdmFyICRsYWJlbCA9ICQoJ2xhYmVsJywgJGxpKTtcbiAgICAgICAgICAgICRsYWJlbC5hZGRDbGFzcyhpbnB1dFR5cGUpO1xuICAgICAgICAgICAgJGxhYmVsLmF0dHIoXCJ0aXRsZVwiLCBsYWJlbCk7XG4gICAgICAgICAgICAkbGkuYWRkQ2xhc3MoY2xhc3Nlcyk7XG5cbiAgICAgICAgICAgIC8vIEhpZGUgYWxsIGNoaWxkcmVuIGl0ZW1zIHdoZW4gY29sbGFwc2VPcHRHcm91cHNCeURlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jb2xsYXBzZU9wdEdyb3Vwc0J5RGVmYXVsdCAmJiAkKGVsZW1lbnQpLnBhcmVudCgpLnByb3AoXCJ0YWdOYW1lXCIpLnRvTG93ZXJDYXNlKCkgPT09IFwib3B0Z3JvdXBcIikge1xuICAgICAgICAgICAgICAgICRsaS5hZGRDbGFzcyhcIm11bHRpc2VsZWN0LWNvbGxhcHNpYmxlLWhpZGRlblwiKTtcbiAgICAgICAgICAgICAgICAkbGkuaGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUhUTUwpIHtcbiAgICAgICAgICAgICAgICAkbGFiZWwuaHRtbChcIiBcIiArIGxhYmVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICRsYWJlbC50ZXh0KFwiIFwiICsgbGFiZWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgJGNoZWNrYm94ID0gJCgnPGlucHV0Lz4nKS5hdHRyKCd0eXBlJywgaW5wdXRUeXBlKTtcblxuICAgICAgICAgICAgdmFyIG5hbWUgPSB0aGlzLm9wdGlvbnMuY2hlY2tib3hOYW1lKCRlbGVtZW50KTtcbiAgICAgICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgJGNoZWNrYm94LmF0dHIoJ25hbWUnLCBuYW1lKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJGxhYmVsLnByZXBlbmQoJGNoZWNrYm94KTtcblxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gJGVsZW1lbnQucHJvcCgnc2VsZWN0ZWQnKSB8fCBmYWxzZTtcbiAgICAgICAgICAgICRjaGVja2JveC52YWwodmFsdWUpO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IHRoaXMub3B0aW9ucy5zZWxlY3RBbGxWYWx1ZSkge1xuICAgICAgICAgICAgICAgICRsaS5hZGRDbGFzcyhcIm11bHRpc2VsZWN0LWl0ZW0gbXVsdGlzZWxlY3QtYWxsXCIpO1xuICAgICAgICAgICAgICAgICRjaGVja2JveC5wYXJlbnQoKS5wYXJlbnQoKVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ211bHRpc2VsZWN0LWFsbCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkbGFiZWwuYXR0cigndGl0bGUnLCAkZWxlbWVudC5hdHRyKCd0aXRsZScpKTtcblxuICAgICAgICAgICAgdGhpcy4kdWwuYXBwZW5kKCRsaSk7XG5cbiAgICAgICAgICAgIGlmICgkZWxlbWVudC5pcygnOmRpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICAkY2hlY2tib3guYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKVxuICAgICAgICAgICAgICAgICAgICAucHJvcCgnZGlzYWJsZWQnLCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAuY2xvc2VzdCgnYScpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGFiaW5kZXhcIiwgXCItMVwiKVxuICAgICAgICAgICAgICAgICAgICAuY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRjaGVja2JveC5wcm9wKCdjaGVja2VkJywgc2VsZWN0ZWQpO1xuXG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWQgJiYgdGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAkY2hlY2tib3guY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcmVhdGVzIGEgZGl2aWRlciB1c2luZyB0aGUgZ2l2ZW4gc2VsZWN0IG9wdGlvbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9IGVsZW1lbnRcbiAgICAgICAgICovXG4gICAgICAgIGNyZWF0ZURpdmlkZXI6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciAkZGl2aWRlciA9ICQodGhpcy5vcHRpb25zLnRlbXBsYXRlcy5kaXZpZGVyKTtcbiAgICAgICAgICAgIHRoaXMuJHVsLmFwcGVuZCgkZGl2aWRlcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyZWF0ZXMgYW4gb3B0Z3JvdXAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSBncm91cFxuICAgICAgICAgKi9cbiAgICAgICAgY3JlYXRlT3B0Z3JvdXA6IGZ1bmN0aW9uKGdyb3VwKSB7XG4gICAgICAgICAgICB2YXIgbGFiZWwgPSAkKGdyb3VwKS5hdHRyKFwibGFiZWxcIik7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAkKGdyb3VwKS5hdHRyKFwidmFsdWVcIik7XG4gICAgICAgICAgICB2YXIgJGxpID0gJCgnPGxpIGNsYXNzPVwibXVsdGlzZWxlY3QtaXRlbSBtdWx0aXNlbGVjdC1ncm91cFwiPjxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+PGxhYmVsPjxiPjwvYj48L2xhYmVsPjwvYT48L2xpPicpO1xuXG4gICAgICAgICAgICB2YXIgY2xhc3NlcyA9IHRoaXMub3B0aW9ucy5vcHRpb25DbGFzcyhncm91cCk7XG4gICAgICAgICAgICAkbGkuYWRkQ2xhc3MoY2xhc3Nlcyk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlSFRNTCkge1xuICAgICAgICAgICAgICAgICQoJ2xhYmVsIGInLCAkbGkpLmh0bWwoXCIgXCIgKyBsYWJlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKCdsYWJlbCBiJywgJGxpKS50ZXh0KFwiIFwiICsgbGFiZWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNvbGxhcHNpYmxlT3B0R3JvdXBzICYmIHRoaXMub3B0aW9ucy5tdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICQoJ2EnLCAkbGkpLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJjYXJldC1jb250YWluZXJcIj48YiBjbGFzcz1cImNhcmV0XCI+PC9iPjwvc3Bhbj4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmFibGVDbGlja2FibGVPcHRHcm91cHMgJiYgdGhpcy5vcHRpb25zLm11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgJCgnYSBsYWJlbCcsICRsaSkucHJlcGVuZCgnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIHZhbHVlPVwiJyArIHZhbHVlICsgJ1wiLz4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCQoZ3JvdXApLmlzKCc6ZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgICAgICRsaS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy4kdWwuYXBwZW5kKCRsaSk7XG5cbiAgICAgICAgICAgICQoXCJvcHRpb25cIiwgZ3JvdXApLmVhY2goJC5wcm94eShmdW5jdGlvbigkLCBncm91cCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlT3B0aW9uVmFsdWUoZ3JvdXApO1xuICAgICAgICAgICAgfSwgdGhpcykpXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJ1aWxkIHRoZSByZXNldC5cbiAgICAgICAgICpcbiAgICAgICAgICovXG4gICAgICAgIGJ1aWxkUmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5pbmNsdWRlUmVzZXRPcHRpb24pIHtcblxuICAgICAgICAgICAgICAgIC8vIENoZWNrIHdoZXRoZXIgdG8gYWRkIGEgZGl2aWRlciBhZnRlciB0aGUgcmVzZXQuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5pbmNsdWRlUmVzZXREaXZpZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJHVsLnByZXBlbmQoJCh0aGlzLm9wdGlvbnMudGVtcGxhdGVzLmRpdmlkZXIpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgJHJlc2V0QnV0dG9uID0gJCh0aGlzLm9wdGlvbnMudGVtcGxhdGVzLnJlc2V0QnV0dG9uKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlSFRNTCkge1xuICAgICAgICAgICAgICAgICAgICAkKCdhJywgJHJlc2V0QnV0dG9uKS5odG1sKHRoaXMub3B0aW9ucy5yZXNldFRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnYScsICRyZXNldEJ1dHRvbikudGV4dCh0aGlzLm9wdGlvbnMucmVzZXRUZXh0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkKCdhJywgJHJlc2V0QnV0dG9uKS5jbGljaygkLnByb3h5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLiR1bC5wcmVwZW5kKCRyZXNldEJ1dHRvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJ1aWxkIHRoZSBzZWxlY3QgYWxsLlxuICAgICAgICAgKlxuICAgICAgICAgKiBDaGVja3MgaWYgYSBzZWxlY3QgYWxsIGhhcyBhbHJlYWR5IGJlZW4gY3JlYXRlZC5cbiAgICAgICAgICovXG4gICAgICAgIGJ1aWxkU2VsZWN0QWxsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLnNlbGVjdEFsbFZhbHVlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5zZWxlY3RBbGxWYWx1ZSA9IHRoaXMub3B0aW9ucy5zZWxlY3RBbGxWYWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYWxyZWFkeUhhc1NlbGVjdEFsbCA9IHRoaXMuaGFzU2VsZWN0QWxsKCk7XG5cbiAgICAgICAgICAgIGlmICghYWxyZWFkeUhhc1NlbGVjdEFsbCAmJiB0aGlzLm9wdGlvbnMuaW5jbHVkZVNlbGVjdEFsbE9wdGlvbiAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGVcbiAgICAgICAgICAgICAgICAmJiAkKCdvcHRpb24nLCB0aGlzLiRzZWxlY3QpLmxlbmd0aCA+IHRoaXMub3B0aW9ucy5pbmNsdWRlU2VsZWN0QWxsSWZNb3JlVGhhbikge1xuXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgd2hldGhlciB0byBhZGQgYSBkaXZpZGVyIGFmdGVyIHRoZSBzZWxlY3QgYWxsLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaW5jbHVkZVNlbGVjdEFsbERpdmlkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kdWwucHJlcGVuZCgkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZXMuZGl2aWRlcikpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciAkbGkgPSAkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZXMubGkpO1xuICAgICAgICAgICAgICAgICQoJ2xhYmVsJywgJGxpKS5hZGRDbGFzcyhcImNoZWNrYm94XCIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmFibGVIVE1MKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJ2xhYmVsJywgJGxpKS5odG1sKFwiIFwiICsgdGhpcy5vcHRpb25zLnNlbGVjdEFsbFRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnbGFiZWwnLCAkbGkpLnRleHQoXCIgXCIgKyB0aGlzLm9wdGlvbnMuc2VsZWN0QWxsVGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RBbGxOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJ2xhYmVsJywgJGxpKS5wcmVwZW5kKCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cIicgKyB0aGlzLm9wdGlvbnMuc2VsZWN0QWxsTmFtZSArICdcIiAvPicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnbGFiZWwnLCAkbGkpLnByZXBlbmQoJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiAvPicpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciAkY2hlY2tib3ggPSAkKCdpbnB1dCcsICRsaSk7XG4gICAgICAgICAgICAgICAgJGNoZWNrYm94LnZhbCh0aGlzLm9wdGlvbnMuc2VsZWN0QWxsVmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgJGxpLmFkZENsYXNzKFwibXVsdGlzZWxlY3QtaXRlbSBtdWx0aXNlbGVjdC1hbGxcIik7XG4gICAgICAgICAgICAgICAgJGNoZWNrYm94LnBhcmVudCgpLnBhcmVudCgpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnbXVsdGlzZWxlY3QtYWxsJyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLiR1bC5wcmVwZW5kKCRsaSk7XG5cbiAgICAgICAgICAgICAgICAkY2hlY2tib3gucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQnVpbGRzIHRoZSBmaWx0ZXIuXG4gICAgICAgICAqL1xuICAgICAgICBidWlsZEZpbHRlcjogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIC8vIEJ1aWxkIGZpbHRlciBpZiBmaWx0ZXJpbmcgT1IgY2FzZSBpbnNlbnNpdGl2ZSBmaWx0ZXJpbmcgaXMgZW5hYmxlZCBhbmQgdGhlIG51bWJlciBvZiBvcHRpb25zIGV4Y2VlZHMgKG9yIGVxdWFscykgZW5hYmxlRmlsdGVyTGVuZ3RoLlxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmFibGVGaWx0ZXJpbmcgfHwgdGhpcy5vcHRpb25zLmVuYWJsZUNhc2VJbnNlbnNpdGl2ZUZpbHRlcmluZykge1xuICAgICAgICAgICAgICAgIHZhciBlbmFibGVGaWx0ZXJMZW5ndGggPSBNYXRoLm1heCh0aGlzLm9wdGlvbnMuZW5hYmxlRmlsdGVyaW5nLCB0aGlzLm9wdGlvbnMuZW5hYmxlQ2FzZUluc2Vuc2l0aXZlRmlsdGVyaW5nKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLiRzZWxlY3QuZmluZCgnb3B0aW9uJykubGVuZ3RoID49IGVuYWJsZUZpbHRlckxlbmd0aCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGZpbHRlciA9ICQodGhpcy5vcHRpb25zLnRlbXBsYXRlcy5maWx0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dCcsIHRoaXMuJGZpbHRlcikuYXR0cigncGxhY2Vob2xkZXInLCB0aGlzLm9wdGlvbnMuZmlsdGVyUGxhY2Vob2xkZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZHMgb3B0aW9uYWwgZmlsdGVyIGNsZWFyIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm9wdGlvbnMuaW5jbHVkZUZpbHRlckNsZWFyQnRuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xlYXJCdG4gPSAkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZXMuZmlsdGVyQ2xlYXJCdG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJCdG4ub24oJ2NsaWNrJywgJC5wcm94eShmdW5jdGlvbihldmVudCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2VhcmNoVGltZW91dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZmlsdGVyLmZpbmQoJy5tdWx0aXNlbGVjdC1zZWFyY2gnKS52YWwoJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2xpJywgdGhpcy4kdWwpLnNob3coKS5yZW1vdmVDbGFzcygnbXVsdGlzZWxlY3QtZmlsdGVyLWhpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RBbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlQ2xpY2thYmxlT3B0R3JvdXBzICYmIHRoaXMub3B0aW9ucy5tdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU9wdEdyb3VwcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZmlsdGVyLmZpbmQoJy5pbnB1dC1ncm91cCcpLmFwcGVuZChjbGVhckJ0bik7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0aGlzLiR1bC5wcmVwZW5kKHRoaXMuJGZpbHRlcik7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZmlsdGVyLnZhbCh0aGlzLnF1ZXJ5KS5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLm9uKCdpbnB1dCBrZXlkb3duJywgJC5wcm94eShmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FuY2VsIGVudGVyIGtleSBkZWZhdWx0IGJlaGF2aW91clxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdXNlZnVsIHRvIGNhdGNoIFwia2V5ZG93blwiIGV2ZW50cyBhZnRlciB0aGUgYnJvd3NlciBoYXMgdXBkYXRlZCB0aGUgY29udHJvbC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNlYXJjaFRpbWVvdXQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaFRpbWVvdXQgPSB0aGlzLmFzeW5jRnVuY3Rpb24oJC5wcm94eShmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5ICE9PSBldmVudC50YXJnZXQudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudEdyb3VwLCBjdXJyZW50R3JvdXBWaXNpYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goJCgnbGknLCB0aGlzLiR1bCksICQucHJveHkoZnVuY3Rpb24oaW5kZXgsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICQoJ2lucHV0JywgZWxlbWVudCkubGVuZ3RoID4gMCA/ICQoJ2lucHV0JywgZWxlbWVudCkudmFsKCkgOiBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKCdsYWJlbCcsIGVsZW1lbnQpLnRleHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlckNhbmRpZGF0ZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh0aGlzLm9wdGlvbnMuZmlsdGVyQmVoYXZpb3IgPT09ICd0ZXh0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJDYW5kaWRhdGUgPSB0ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHRoaXMub3B0aW9ucy5maWx0ZXJCZWhhdmlvciA9PT0gJ3ZhbHVlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJDYW5kaWRhdGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMub3B0aW9ucy5maWx0ZXJCZWhhdmlvciA9PT0gJ2JvdGgnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQ2FuZGlkYXRlID0gdGV4dCArICdcXG4nICsgdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5vcHRpb25zLnNlbGVjdEFsbFZhbHVlICYmIHRleHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJ5IGRlZmF1bHQgbGV0cyBhc3N1bWUgdGhhdCBlbGVtZW50IGlzIG5vdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludGVyZXN0aW5nIGZvciB0aGlzIHNlYXJjaC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hvd0VsZW1lbnQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlQ2FzZUluc2Vuc2l0aXZlRmlsdGVyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckNhbmRpZGF0ZSA9IGZpbHRlckNhbmRpZGF0ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5ID0gdGhpcy5xdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlRnVsbFZhbHVlRmlsdGVyaW5nICYmIHRoaXMub3B0aW9ucy5maWx0ZXJCZWhhdmlvciAhPT0gJ2JvdGgnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZVRvTWF0Y2ggPSBmaWx0ZXJDYW5kaWRhdGUudHJpbSgpLnN1YnN0cmluZygwLCB0aGlzLnF1ZXJ5Lmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5LmluZGV4T2YodmFsdWVUb01hdGNoKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93RWxlbWVudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZmlsdGVyQ2FuZGlkYXRlLmluZGV4T2YodGhpcy5xdWVyeSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93RWxlbWVudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVG9nZ2xlIGN1cnJlbnQgZWxlbWVudCAoZ3JvdXAgb3IgZ3JvdXAgaXRlbSkgYWNjb3JkaW5nIHRvIHNob3dFbGVtZW50IGJvb2xlYW4uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXNob3dFbGVtZW50KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChlbGVtZW50KS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLmFkZENsYXNzKCdtdWx0aXNlbGVjdC1maWx0ZXItaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNob3dFbGVtZW50KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChlbGVtZW50KS5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChlbGVtZW50KS5yZW1vdmVDbGFzcygnbXVsdGlzZWxlY3QtZmlsdGVyLWhpZGRlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERpZmZlcmVudGlhdGUgZ3JvdXBzIGFuZCBncm91cCBpdGVtcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJChlbGVtZW50KS5oYXNDbGFzcygnbXVsdGlzZWxlY3QtZ3JvdXAnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1lbWJlciBncm91cCBzdGF0dXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cCA9IGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cFZpc2libGUgPSBzaG93RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNob3cgZ3JvdXAgbmFtZSB3aGVuIGF0IGxlYXN0IG9uZSBvZiBpdHMgaXRlbXMgaXMgdmlzaWJsZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNob3dFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGN1cnJlbnRHcm91cCkuc2hvdygpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdtdWx0aXNlbGVjdC1maWx0ZXItaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTaG93IGFsbCBncm91cCBpdGVtcyB3aGVuIGdyb3VwIG5hbWUgc2F0aXNmaWVzIGZpbHRlci5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzaG93RWxlbWVudCAmJiBjdXJyZW50R3JvdXBWaXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnNob3coKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnbXVsdGlzZWxlY3QtZmlsdGVyLWhpZGRlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RBbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlQ2xpY2thYmxlT3B0R3JvdXBzICYmIHRoaXMub3B0aW9ucy5tdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU9wdEdyb3VwcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkZpbHRlcmluZyhldmVudC50YXJnZXQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwgMzAwLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogVW5iaW5kcyB0aGUgd2hvbGUgcGx1Z2luLlxuICAgICAgICAgKi9cbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLiRjb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLiRzZWxlY3Quc2hvdygpO1xuXG4gICAgICAgICAgICAvLyByZXNldCBvcmlnaW5hbCBzdGF0ZVxuICAgICAgICAgICAgdGhpcy4kc2VsZWN0LnByb3AoJ2Rpc2FibGVkJywgdGhpcy5vcHRpb25zLndhc0Rpc2FibGVkKTtcblxuICAgICAgICAgICAgdGhpcy4kc2VsZWN0LmRhdGEoJ211bHRpc2VsZWN0JywgbnVsbCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlZnJlc2hzIHRoZSBtdWx0aXNlbGVjdCBiYXNlZCBvbiB0aGUgc2VsZWN0ZWQgb3B0aW9ucyBvZiB0aGUgc2VsZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgcmVmcmVzaDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlucHV0cyA9IHt9O1xuICAgICAgICAgICAgJCgnbGkgaW5wdXQnLCB0aGlzLiR1bCkuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpbnB1dHNbJCh0aGlzKS52YWwoKV0gPSAkKHRoaXMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoJ29wdGlvbicsIHRoaXMuJHNlbGVjdCkuZWFjaCgkLnByb3h5KGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHZhciAkZWxlbSA9ICQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdmFyICRpbnB1dCA9IGlucHV0c1skKGVsZW1lbnQpLnZhbCgpXTtcblxuICAgICAgICAgICAgICAgIGlmICgkZWxlbS5pcygnOnNlbGVjdGVkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgJGlucHV0LnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRpbnB1dC5jbG9zZXN0KCdsaScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJGlucHV0LnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5wdXQuY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoJGVsZW0uaXMoXCI6ZGlzYWJsZWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgJGlucHV0LmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJGlucHV0LnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgICAgICAgdGhpcy51cGRhdGVCdXR0b25UZXh0KCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdEFsbCgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNsaWNrYWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU9wdEdyb3VwcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZWxlY3QgYWxsIG9wdGlvbnMgb2YgdGhlIGdpdmVuIHZhbHVlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogSWYgdHJpZ2dlck9uQ2hhbmdlIGlzIHNldCB0byB0cnVlLCB0aGUgb24gY2hhbmdlIGV2ZW50IGlzIHRyaWdnZXJlZCBpZlxuICAgICAgICAgKiBhbmQgb25seSBpZiBvbmUgdmFsdWUgaXMgcGFzc2VkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBzZWxlY3RWYWx1ZXNcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSB0cmlnZ2VyT25DaGFuZ2VcbiAgICAgICAgICovXG4gICAgICAgIHNlbGVjdDogZnVuY3Rpb24oc2VsZWN0VmFsdWVzLCB0cmlnZ2VyT25DaGFuZ2UpIHtcbiAgICAgICAgICAgIGlmKCEkLmlzQXJyYXkoc2VsZWN0VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgIHNlbGVjdFZhbHVlcyA9IFtzZWxlY3RWYWx1ZXNdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdFZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHNlbGVjdFZhbHVlc1tpXTtcblxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciAkb3B0aW9uID0gdGhpcy5nZXRPcHRpb25CeVZhbHVlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB2YXIgJGNoZWNrYm94ID0gdGhpcy5nZXRJbnB1dEJ5VmFsdWUodmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgaWYoJG9wdGlvbiA9PT0gdW5kZWZpbmVkIHx8ICRjaGVja2JveCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLm11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzZWxlY3RBbGwoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICAkY2hlY2tib3guY2xvc2VzdCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkY2hlY2tib3gucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIGlmICh0cmlnZ2VyT25DaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uQ2hhbmdlKCRvcHRpb24sIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy51cGRhdGVCdXR0b25UZXh0KCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdEFsbCgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNsaWNrYWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU9wdEdyb3VwcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDbGVhcnMgYWxsIHNlbGVjdGVkIGl0ZW1zLlxuICAgICAgICAgKi9cbiAgICAgICAgY2xlYXJTZWxlY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzZWxlY3RBbGwoZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVCdXR0b25UZXh0KCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdEFsbCgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNsaWNrYWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU9wdEdyb3VwcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZXNlbGVjdHMgYWxsIG9wdGlvbnMgb2YgdGhlIGdpdmVuIHZhbHVlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogSWYgdHJpZ2dlck9uQ2hhbmdlIGlzIHNldCB0byB0cnVlLCB0aGUgb24gY2hhbmdlIGV2ZW50IGlzIHRyaWdnZXJlZCwgaWZcbiAgICAgICAgICogYW5kIG9ubHkgaWYgb25lIHZhbHVlIGlzIHBhc3NlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtBcnJheX0gZGVzZWxlY3RWYWx1ZXNcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSB0cmlnZ2VyT25DaGFuZ2VcbiAgICAgICAgICovXG4gICAgICAgIGRlc2VsZWN0OiBmdW5jdGlvbihkZXNlbGVjdFZhbHVlcywgdHJpZ2dlck9uQ2hhbmdlKSB7XG4gICAgICAgICAgICBpZighJC5pc0FycmF5KGRlc2VsZWN0VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgIGRlc2VsZWN0VmFsdWVzID0gW2Rlc2VsZWN0VmFsdWVzXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZXNlbGVjdFZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRlc2VsZWN0VmFsdWVzW2ldO1xuXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyICRvcHRpb24gPSB0aGlzLmdldE9wdGlvbkJ5VmFsdWUodmFsdWUpO1xuICAgICAgICAgICAgICAgIHZhciAkY2hlY2tib3ggPSB0aGlzLmdldElucHV0QnlWYWx1ZSh2YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICBpZigkb3B0aW9uID09PSB1bmRlZmluZWQgfHwgJGNoZWNrYm94ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICRjaGVja2JveC5jbG9zZXN0KCdsaScpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRjaGVja2JveC5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodHJpZ2dlck9uQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkNoYW5nZSgkb3B0aW9uLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUJ1dHRvblRleHQoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0QWxsKCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlQ2xpY2thYmxlT3B0R3JvdXBzICYmIHRoaXMub3B0aW9ucy5tdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlT3B0R3JvdXBzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNlbGVjdHMgYWxsIGVuYWJsZWQgJiB2aXNpYmxlIG9wdGlvbnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIElmIGp1c3RWaXNpYmxlIGlzIHRydWUgb3Igbm90IHNwZWNpZmllZCwgb25seSB2aXNpYmxlIG9wdGlvbnMgYXJlIHNlbGVjdGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGp1c3RWaXNpYmxlXG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gdHJpZ2dlck9uU2VsZWN0QWxsXG4gICAgICAgICAqL1xuICAgICAgICBzZWxlY3RBbGw6IGZ1bmN0aW9uIChqdXN0VmlzaWJsZSwgdHJpZ2dlck9uU2VsZWN0QWxsKSB7XG5cbiAgICAgICAgICAgIHZhciBqdXN0VmlzaWJsZSA9IHR5cGVvZiBqdXN0VmlzaWJsZSA9PT0gJ3VuZGVmaW5lZCcgPyB0cnVlIDoganVzdFZpc2libGU7XG4gICAgICAgICAgICB2YXIgYWxsTGlzID0gJChcImxpOm5vdCguZGl2aWRlcik6bm90KC5kaXNhYmxlZCk6bm90KC5tdWx0aXNlbGVjdC1ncm91cClcIiwgdGhpcy4kdWwpO1xuICAgICAgICAgICAgdmFyIHZpc2libGVMaXMgPSAkKFwibGk6bm90KC5kaXZpZGVyKTpub3QoLmRpc2FibGVkKTpub3QoLm11bHRpc2VsZWN0LWdyb3VwKTpub3QoLm11bHRpc2VsZWN0LWZpbHRlci1oaWRkZW4pOm5vdCgubXVsdGlzZWxlY3QtY29sbGFwaXNibGUtaGlkZGVuKVwiLCB0aGlzLiR1bCkuZmlsdGVyKCc6dmlzaWJsZScpO1xuXG4gICAgICAgICAgICBpZihqdXN0VmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICQoJ2lucHV0OmVuYWJsZWQnICwgdmlzaWJsZUxpcykucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgIHZpc2libGVMaXMuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgJCgnaW5wdXQ6ZW5hYmxlZCcgLCB2aXNpYmxlTGlzKS5lYWNoKCQucHJveHkoZnVuY3Rpb24oaW5kZXgsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gJChlbGVtZW50KS52YWwoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IHRoaXMuZ2V0T3B0aW9uQnlWYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICQob3B0aW9uKS5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICQoJ2lucHV0OmVuYWJsZWQnICwgYWxsTGlzKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgYWxsTGlzLmFkZENsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcblxuICAgICAgICAgICAgICAgICQoJ2lucHV0OmVuYWJsZWQnICwgYWxsTGlzKS5lYWNoKCQucHJveHkoZnVuY3Rpb24oaW5kZXgsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gJChlbGVtZW50KS52YWwoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IHRoaXMuZ2V0T3B0aW9uQnlWYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICQob3B0aW9uKS5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJCgnbGkgaW5wdXRbdmFsdWU9XCInICsgdGhpcy5vcHRpb25zLnNlbGVjdEFsbFZhbHVlICsgJ1wiXScsIHRoaXMuJHVsKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlQ2xpY2thYmxlT3B0R3JvdXBzICYmIHRoaXMub3B0aW9ucy5tdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlT3B0R3JvdXBzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0cmlnZ2VyT25TZWxlY3RBbGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25TZWxlY3RBbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVzZWxlY3RzIGFsbCBvcHRpb25zLlxuICAgICAgICAgKlxuICAgICAgICAgKiBJZiBqdXN0VmlzaWJsZSBpcyB0cnVlIG9yIG5vdCBzcGVjaWZpZWQsIG9ubHkgdmlzaWJsZSBvcHRpb25zIGFyZSBkZXNlbGVjdGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGp1c3RWaXNpYmxlXG4gICAgICAgICAqL1xuICAgICAgICBkZXNlbGVjdEFsbDogZnVuY3Rpb24gKGp1c3RWaXNpYmxlLCB0cmlnZ2VyT25EZXNlbGVjdEFsbCkge1xuXG4gICAgICAgICAgICB2YXIganVzdFZpc2libGUgPSB0eXBlb2YganVzdFZpc2libGUgPT09ICd1bmRlZmluZWQnID8gdHJ1ZSA6IGp1c3RWaXNpYmxlO1xuICAgICAgICAgICAgdmFyIGFsbExpcyA9ICQoXCJsaTpub3QoLmRpdmlkZXIpOm5vdCguZGlzYWJsZWQpOm5vdCgubXVsdGlzZWxlY3QtZ3JvdXApXCIsIHRoaXMuJHVsKTtcbiAgICAgICAgICAgIHZhciB2aXNpYmxlTGlzID0gJChcImxpOm5vdCguZGl2aWRlcik6bm90KC5kaXNhYmxlZCk6bm90KC5tdWx0aXNlbGVjdC1ncm91cCk6bm90KC5tdWx0aXNlbGVjdC1maWx0ZXItaGlkZGVuKTpub3QoLm11bHRpc2VsZWN0LWNvbGxhcGlzYmxlLWhpZGRlbilcIiwgdGhpcy4kdWwpLmZpbHRlcignOnZpc2libGUnKTtcblxuICAgICAgICAgICAgaWYoanVzdFZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAkKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl06ZW5hYmxlZCcgLCB2aXNpYmxlTGlzKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHZpc2libGVMaXMucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmVuYWJsZWQnICwgdmlzaWJsZUxpcykuZWFjaCgkLnByb3h5KGZ1bmN0aW9uKGluZGV4LCBlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICQoZWxlbWVudCkudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSB0aGlzLmdldE9wdGlvbkJ5VmFsdWUodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAkKG9wdGlvbikucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSwgdGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmVuYWJsZWQnICwgYWxsTGlzKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGFsbExpcy5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyk7XG5cbiAgICAgICAgICAgICAgICAkKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl06ZW5hYmxlZCcgLCBhbGxMaXMpLmVhY2goJC5wcm94eShmdW5jdGlvbihpbmRleCwgZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSAkKGVsZW1lbnQpLnZhbCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gdGhpcy5nZXRPcHRpb25CeVZhbHVlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgJChvcHRpb24pLnByb3AoJ3NlbGVjdGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJCgnbGkgaW5wdXRbdmFsdWU9XCInICsgdGhpcy5vcHRpb25zLnNlbGVjdEFsbFZhbHVlICsgJ1wiXScsIHRoaXMuJHVsKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNsaWNrYWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU9wdEdyb3VwcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHJpZ2dlck9uRGVzZWxlY3RBbGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25EZXNlbGVjdEFsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZWJ1aWxkIHRoZSBwbHVnaW4uXG4gICAgICAgICAqXG4gICAgICAgICAqIFJlYnVpbGRzIHRoZSBkcm9wZG93biwgdGhlIGZpbHRlciBhbmQgdGhlIHNlbGVjdCBhbGwgb3B0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVidWlsZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLiR1bC5odG1sKCcnKTtcblxuICAgICAgICAgICAgLy8gSW1wb3J0YW50IHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gcmFkaW9zIGFuZCBjaGVja2JveGVzLlxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm11bHRpcGxlID0gdGhpcy4kc2VsZWN0LmF0dHIoJ211bHRpcGxlJykgPT09IFwibXVsdGlwbGVcIjtcblxuICAgICAgICAgICAgdGhpcy5idWlsZFNlbGVjdEFsbCgpO1xuICAgICAgICAgICAgdGhpcy5idWlsZERyb3Bkb3duT3B0aW9ucygpO1xuICAgICAgICAgICAgdGhpcy5idWlsZEZpbHRlcigpO1xuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUJ1dHRvblRleHQoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0QWxsKHRydWUpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmVuYWJsZUNsaWNrYWJsZU9wdEdyb3VwcyAmJiB0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU9wdEdyb3VwcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRpc2FibGVJZkVtcHR5ICYmICQoJ29wdGlvbicsIHRoaXMuJHNlbGVjdCkubGVuZ3RoIDw9IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZHJvcFJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kdWwuYWRkQ2xhc3MoJ3B1bGwtcmlnaHQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHByb3ZpZGVkIGRhdGEgd2lsbCBiZSB1c2VkIHRvIGJ1aWxkIHRoZSBkcm9wZG93bi5cbiAgICAgICAgICovXG4gICAgICAgIGRhdGFwcm92aWRlcjogZnVuY3Rpb24oZGF0YXByb3ZpZGVyKSB7XG5cbiAgICAgICAgICAgIHZhciBncm91cENvdW50ZXIgPSAwO1xuICAgICAgICAgICAgdmFyICRzZWxlY3QgPSB0aGlzLiRzZWxlY3QuZW1wdHkoKTtcblxuICAgICAgICAgICAgJC5lYWNoKGRhdGFwcm92aWRlciwgZnVuY3Rpb24gKGluZGV4LCBvcHRpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgJHRhZztcblxuICAgICAgICAgICAgICAgIGlmICgkLmlzQXJyYXkob3B0aW9uLmNoaWxkcmVuKSkgeyAvLyBjcmVhdGUgb3B0aW9uZ3JvdXAgdGFnXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwQ291bnRlcisrO1xuXG4gICAgICAgICAgICAgICAgICAgICR0YWcgPSAkKCc8b3B0Z3JvdXAvPicpLmF0dHIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG9wdGlvbi5sYWJlbCB8fCAnR3JvdXAgJyArIGdyb3VwQ291bnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAhIW9wdGlvbi5kaXNhYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvcHRpb24udmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yRWFjaChvcHRpb24uY2hpbGRyZW4sIGZ1bmN0aW9uKHN1Yk9wdGlvbikgeyAvLyBhZGQgY2hpbGRyZW4gb3B0aW9uIHRhZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzdWJPcHRpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHN1Yk9wdGlvbi5sYWJlbCB8fCBzdWJPcHRpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHN1Yk9wdGlvbi50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogISFzdWJPcHRpb24uc2VsZWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6ICEhc3ViT3B0aW9uLmRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0xvb3AgdGhyb3VnaCBhdHRyaWJ1dGVzIG9iamVjdCBhbmQgYWRkIGtleS12YWx1ZSBmb3IgZWFjaCBhdHRyaWJ1dGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzdWJPcHRpb24uYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNbJ2RhdGEtJyArIGtleV0gPSBzdWJPcHRpb24uYXR0cmlidXRlc1trZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9BcHBlbmQgb3JpZ2luYWwgYXR0cmlidXRlcyArIG5ldyBkYXRhIGF0dHJpYnV0ZXMgdG8gb3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGFnLmFwcGVuZCgkKCc8b3B0aW9uLz4nKS5hdHRyKGF0dHJpYnV0ZXMpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhbHVlJzogb3B0aW9uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJzogb3B0aW9uLmxhYmVsIHx8IG9wdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0aXRsZSc6IG9wdGlvbi50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjbGFzcyc6IG9wdGlvblsnY2xhc3MnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWxlY3RlZCc6ICEhb3B0aW9uWydzZWxlY3RlZCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc2FibGVkJzogISFvcHRpb25bJ2Rpc2FibGVkJ11cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgLy9Mb29wIHRocm91Z2ggYXR0cmlidXRlcyBvYmplY3QgYW5kIGFkZCBrZXktdmFsdWUgZm9yIGVhY2ggYXR0cmlidXRlXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvcHRpb24uYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1snZGF0YS0nICsga2V5XSA9IG9wdGlvbi5hdHRyaWJ1dGVzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9BcHBlbmQgb3JpZ2luYWwgYXR0cmlidXRlcyArIG5ldyBkYXRhIGF0dHJpYnV0ZXMgdG8gb3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICR0YWcgPSAkKCc8b3B0aW9uLz4nKS5hdHRyKGF0dHJpYnV0ZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICR0YWcudGV4dChvcHRpb24ubGFiZWwgfHwgb3B0aW9uLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkc2VsZWN0LmFwcGVuZCgkdGFnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnJlYnVpbGQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRW5hYmxlIHRoZSBtdWx0aXNlbGVjdC5cbiAgICAgICAgICovXG4gICAgICAgIGVuYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLiRzZWxlY3QucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLiRidXR0b24ucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSlcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc2FibGUgdGhlIG11bHRpc2VsZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgZGlzYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLiRzZWxlY3QucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuJGJ1dHRvbi5wcm9wKCdkaXNhYmxlZCcsIHRydWUpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgdGhlIG9wdGlvbnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7QXJyYXl9IG9wdGlvbnNcbiAgICAgICAgICovXG4gICAgICAgIHNldE9wdGlvbnM6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMubWVyZ2VPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNZXJnZXMgdGhlIGdpdmVuIG9wdGlvbnMgd2l0aCB0aGUgZGVmYXVsdCBvcHRpb25zLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBvcHRpb25zXG4gICAgICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgICAgICovXG4gICAgICAgIG1lcmdlT3B0aW9uczogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLmRlZmF1bHRzLCB0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDaGVja3Mgd2hldGhlciBhIHNlbGVjdCBhbGwgY2hlY2tib3ggaXMgcHJlc2VudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBoYXNTZWxlY3RBbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICQoJ2xpLm11bHRpc2VsZWN0LWFsbCcsIHRoaXMuJHVsKS5sZW5ndGggPiAwO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVcGRhdGUgb3B0IGdyb3Vwcy5cbiAgICAgICAgICovXG4gICAgICAgIHVwZGF0ZU9wdEdyb3VwczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgJGdyb3VwcyA9ICQoJ2xpLm11bHRpc2VsZWN0LWdyb3VwJywgdGhpcy4kdWwpXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDbGFzcyA9IHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzO1xuXG4gICAgICAgICAgICAkZ3JvdXBzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyICRvcHRpb25zID0gJCh0aGlzKS5uZXh0VW50aWwoJ2xpLm11bHRpc2VsZWN0LWdyb3VwJylcbiAgICAgICAgICAgICAgICAgICAgLm5vdCgnLm11bHRpc2VsZWN0LWZpbHRlci1oaWRkZW4nKVxuICAgICAgICAgICAgICAgICAgICAubm90KCcuZGlzYWJsZWQnKTtcblxuICAgICAgICAgICAgICAgIHZhciBjaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkb3B0aW9ucy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGlucHV0ID0gJCgnaW5wdXQnLCB0aGlzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoISRpbnB1dC5wcm9wKCdjaGVja2VkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3Moc2VsZWN0ZWRDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKHNlbGVjdGVkQ2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJCgnaW5wdXQnLCB0aGlzKS5wcm9wKCdjaGVja2VkJywgY2hlY2tlZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlcyB0aGUgc2VsZWN0IGFsbCBjaGVja2JveCBiYXNlZCBvbiB0aGUgY3VycmVudGx5IGRpc3BsYXllZCBhbmQgc2VsZWN0ZWQgY2hlY2tib3hlcy5cbiAgICAgICAgICovXG4gICAgICAgIHVwZGF0ZVNlbGVjdEFsbDogZnVuY3Rpb24obm90VHJpZ2dlck9uU2VsZWN0QWxsKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5oYXNTZWxlY3RBbGwoKSkge1xuICAgICAgICAgICAgICAgIHZhciBhbGxCb3hlcyA9ICQoXCJsaTpub3QoLm11bHRpc2VsZWN0LWl0ZW0pOm5vdCgubXVsdGlzZWxlY3QtZmlsdGVyLWhpZGRlbik6bm90KC5tdWx0aXNlbGVjdC1ncm91cCk6bm90KC5kaXNhYmxlZCkgaW5wdXQ6ZW5hYmxlZFwiLCB0aGlzLiR1bCk7XG4gICAgICAgICAgICAgICAgdmFyIGFsbEJveGVzTGVuZ3RoID0gYWxsQm94ZXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBjaGVja2VkQm94ZXNMZW5ndGggPSBhbGxCb3hlcy5maWx0ZXIoXCI6Y2hlY2tlZFwiKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdEFsbExpICA9ICQoXCJsaS5tdWx0aXNlbGVjdC1hbGxcIiwgdGhpcy4kdWwpO1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RBbGxJbnB1dCA9IHNlbGVjdEFsbExpLmZpbmQoXCJpbnB1dFwiKTtcblxuICAgICAgICAgICAgICAgIGlmIChjaGVja2VkQm94ZXNMZW5ndGggPiAwICYmIGNoZWNrZWRCb3hlc0xlbmd0aCA9PT0gYWxsQm94ZXNMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0QWxsSW5wdXQucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdEFsbExpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdEFsbElucHV0LnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0QWxsTGkucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlIHRoZSBidXR0b24gdGV4dCBhbmQgaXRzIHRpdGxlIGJhc2VkIG9uIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgb3B0aW9ucy5cbiAgICAgICAgICovXG4gICAgICAgIHVwZGF0ZUJ1dHRvblRleHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmdldFNlbGVjdGVkKCk7XG5cbiAgICAgICAgICAgIC8vIEZpcnN0IHVwZGF0ZSB0aGUgZGlzcGxheWVkIGJ1dHRvbiB0ZXh0LlxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5lbmFibGVIVE1MKSB7XG4gICAgICAgICAgICAgICAgJCgnLm11bHRpc2VsZWN0IC5tdWx0aXNlbGVjdC1zZWxlY3RlZC10ZXh0JywgdGhpcy4kY29udGFpbmVyKS5odG1sKHRoaXMub3B0aW9ucy5idXR0b25UZXh0KG9wdGlvbnMsIHRoaXMuJHNlbGVjdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgJCgnLm11bHRpc2VsZWN0IC5tdWx0aXNlbGVjdC1zZWxlY3RlZC10ZXh0JywgdGhpcy4kY29udGFpbmVyKS50ZXh0KHRoaXMub3B0aW9ucy5idXR0b25UZXh0KG9wdGlvbnMsIHRoaXMuJHNlbGVjdCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBOb3cgdXBkYXRlIHRoZSB0aXRsZSBhdHRyaWJ1dGUgb2YgdGhlIGJ1dHRvbi5cbiAgICAgICAgICAgICQoJy5tdWx0aXNlbGVjdCcsIHRoaXMuJGNvbnRhaW5lcikuYXR0cigndGl0bGUnLCB0aGlzLm9wdGlvbnMuYnV0dG9uVGl0bGUob3B0aW9ucywgdGhpcy4kc2VsZWN0KSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBhbGwgc2VsZWN0ZWQgb3B0aW9ucy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJldHVybnMge2pRVWVyeX1cbiAgICAgICAgICovXG4gICAgICAgIGdldFNlbGVjdGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkKCdvcHRpb24nLCB0aGlzLiRzZWxlY3QpLmZpbHRlcihcIjpzZWxlY3RlZFwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0cyBhIHNlbGVjdCBvcHRpb24gYnkgaXRzIHZhbHVlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVcbiAgICAgICAgICogQHJldHVybnMge2pRdWVyeX1cbiAgICAgICAgICovXG4gICAgICAgIGdldE9wdGlvbkJ5VmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICQoJ29wdGlvbicsIHRoaXMuJHNlbGVjdCk7XG4gICAgICAgICAgICB2YXIgdmFsdWVUb0NvbXBhcmUgPSB2YWx1ZS50b1N0cmluZygpO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9wdGlvbnMubGVuZ3RoOyBpID0gaSArIDEpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gb3B0aW9uc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uLnZhbHVlID09PSB2YWx1ZVRvQ29tcGFyZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJChvcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHRoZSBpbnB1dCAocmFkaW8vY2hlY2tib3gpIGJ5IGl0cyB2YWx1ZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gICAgICAgICAqIEByZXR1cm5zIHtqUXVlcnl9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRJbnB1dEJ5VmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXG4gICAgICAgICAgICB2YXIgY2hlY2tib3hlcyA9ICQoJ2xpIGlucHV0Om5vdCgubXVsdGlzZWxlY3Qtc2VhcmNoKScsIHRoaXMuJHVsKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZVRvQ29tcGFyZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hlY2tib3hlcy5sZW5ndGg7IGkgPSBpICsgMSkge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja2JveCA9IGNoZWNrYm94ZXNbaV07XG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrYm94LnZhbHVlID09PSB2YWx1ZVRvQ29tcGFyZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJChjaGVja2JveCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2VkIGZvciBrbm9ja291dCBpbnRlZ3JhdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHVwZGF0ZU9yaWdpbmFsT3B0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsT3B0aW9ucyA9IHRoaXMuJHNlbGVjdC5jbG9uZSgpWzBdLm9wdGlvbnM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXN5bmNGdW5jdGlvbjogZnVuY3Rpb24oY2FsbGJhY2ssIHRpbWVvdXQsIHNlbGYpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAzKTtcbiAgICAgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHNlbGYgfHwgd2luZG93LCBhcmdzKTtcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldEFsbFNlbGVjdGVkVGV4dDogZnVuY3Rpb24oYWxsU2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuYWxsU2VsZWN0ZWRUZXh0ID0gYWxsU2VsZWN0ZWRUZXh0O1xuICAgICAgICAgICAgdGhpcy51cGRhdGVCdXR0b25UZXh0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJC5mbi5tdWx0aXNlbGVjdCA9IGZ1bmN0aW9uKG9wdGlvbiwgcGFyYW1ldGVyLCBleHRyYU9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gJCh0aGlzKS5kYXRhKCdtdWx0aXNlbGVjdCcpO1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9uID09PSAnb2JqZWN0JyAmJiBvcHRpb247XG5cbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIG11bHRpc2VsZWN0LlxuICAgICAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IG5ldyBNdWx0aXNlbGVjdCh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ211bHRpc2VsZWN0JywgZGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENhbGwgbXVsdGlzZWxlY3QgbWV0aG9kLlxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgZGF0YVtvcHRpb25dKHBhcmFtZXRlciwgZXh0cmFPcHRpb25zKTtcblxuICAgICAgICAgICAgICAgIGlmIChvcHRpb24gPT09ICdkZXN0cm95Jykge1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ211bHRpc2VsZWN0JywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICQuZm4ubXVsdGlzZWxlY3QuQ29uc3RydWN0b3IgPSBNdWx0aXNlbGVjdDtcblxuICAgICQoZnVuY3Rpb24oKSB7XG4gICAgICAgICQoXCJzZWxlY3RbZGF0YS1yb2xlPW11bHRpc2VsZWN0XVwiKS5tdWx0aXNlbGVjdCgpO1xuICAgIH0pO1xuXG59KTsiXX0=
